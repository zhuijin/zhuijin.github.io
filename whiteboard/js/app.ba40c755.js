(function(){"use strict";var e={9208:function(e,t,n){var o,l=n(9242),a=n(3396),i=n(4870),s=n(7139);(function(e){e["PEN"]="PEN",e["MOUSE"]="MOUSE",e["CLEAR"]="CLEAR",e["ERASER"]="ERASER"})(o||(o={}));const r={viewBox:"0 0 320 512"},u=(0,a._)("path",{d:"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"},null,-1),c=[u];function v(e,t){return(0,a.wg)(),(0,a.iD)("svg",r,c)}var d=n(89);const h={},p=(0,d.Z)(h,[["render",v]]);var f=p;const g={viewBox:"0 0 512 512"},w=(0,a._)("path",{fill:"currentColor",d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"},null,-1),m=[w];function y(e,t){return(0,a.wg)(),(0,a.iD)("svg",g,m)}const b={},k=(0,d.Z)(b,[["render",y]]);var E=k;const x={viewBox:"0 0 1024 1024"},O=(0,a._)("path",{d:"M904.533333 674.133333l-362.666666-362.666666c-17.066667-17.066667-42.666667-17.066667-59.733334 0l-362.666666 362.666666c-17.066667 17.066667-17.066667 42.666667 0 59.733334 17.066667 17.066667 42.666667 17.066667 59.733333 0L512 401.066667l332.8 332.8c8.533333 8.533333 19.2 12.8 29.866667 12.8s21.333333-4.266667 29.866666-12.8c17.066667-17.066667 17.066667-42.666667 0-59.733334z"},null,-1),S=[O];function C(e,t){return(0,a.wg)(),(0,a.iD)("svg",x,S)}const _={},M=(0,d.Z)(_,[["render",C]]);var R=M;const T={viewBox:"0 0 448 512"},z=(0,a._)("path",{fill:"currentColor",d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},null,-1),A=[z];function U(e,t){return(0,a.wg)(),(0,a.iD)("svg",T,A)}const D={},L=(0,d.Z)(D,[["render",U]]);var H=L;const W={viewBox:"0 0 448 512"},N=(0,a._)("path",{fill:"currentColor",d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},null,-1),P=[N];function Y(e,t){return(0,a.wg)(),(0,a.iD)("svg",W,P)}const j={},B=(0,d.Z)(j,[["render",Y]]);var F=B;const X={class:"wb-step"},Z=["value"],I={key:1,class:"web-step-value-readonly"};var q=(0,a.aZ)({name:"Step",props:{inputValue:{type:[String,Number],default:0},disabled:{type:Boolean,default:!1}},emits:["reduce","add","input"],setup(e,{emit:t}){const n=e,{inputValue:o,disabled:l}=(0,i.BK)(n),r=()=>t("reduce"),u=()=>t("add"),c=e=>{const n=Number(e.target.value);n<1&&(e.target.value="1"),t("input",n<1?1:n)};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",X,[(0,a._)("div",{class:"wb-step-btn",onClick:t[0]||(t[0]=e=>r())},[(0,a.Wm)(F)]),(0,i.SU)(l)?((0,a.wg)(),(0,a.iD)("div",I,(0,s.zw)((0,i.SU)(o)),1)):((0,a.wg)(),(0,a.iD)("input",{key:0,value:(0,i.SU)(o),type:"number",min:"1",onInput:t[1]||(t[1]=e=>c(e)),class:"wb-step-value"},null,40,Z)),(0,a._)("div",{class:"wb-step-btn",onClick:t[2]||(t[2]=e=>u())},[(0,a.Wm)(H)])]))}});const V=(0,d.Z)(q,[["__scopeId","data-v-5d9424c5"]]);var K=V;const G={viewBox:"0 0 1024 1024"},J=(0,a._)("path",{d:"M433.664 250.88L773.12 590.336 599.466667 837.162667a42.666667 42.666667 0 0 1-65.066667 5.632l-61.333333-61.333334v-130.88h-130.858667L181.205333 489.6a42.666667 42.666667 0 0 1 5.632-65.066667l246.826667-173.632z m38.378667-26.986667l66.133333-46.528a42.666667 42.666667 0 0 1 54.72 4.714667l89.130667 89.152 93.781333-93.781333a21.333333 21.333333 0 0 1 30.165333 0l35.2 35.2a21.333333 21.333333 0 0 1 0 30.186666l-93.76 93.76 94.506667 94.506667a42.666667 42.666667 0 0 1 4.714667 54.72l-46.506667 66.133333-328.106667-328.064z"},null,-1),Q=[J];function $(e,t){return(0,a.wg)(),(0,a.iD)("svg",G,Q)}const ee={},te=(0,d.Z)(ee,[["render",$]]);var ne=te;n(6699);const oe={viewBox:"0 0 1024 1024"},le=(0,a._)("path",{d:"M892.064 261.888a31.936 31.936 0 0 0-45.216 1.472L421.664 717.248 201.216 532.032a32 32 0 1 0-41.152 48.992l243.648 204.704a31.872 31.872 0 0 0 20.576 7.488 31.808 31.808 0 0 0 23.36-10.112l445.888-475.968a32 32 0 0 0-1.472-45.248z"},null,-1),ae=[le];function ie(e,t){return(0,a.wg)(),(0,a.iD)("svg",oe,ae)}const se={},re=(0,d.Z)(se,[["render",ie]]);var ue=re,ce=n(7013),ve=n.n(ce),de=n(4806);const he=e=>((0,a.dD)("data-v-0d8140ba"),e=e(),(0,a.Cn)(),e),pe=he((()=>(0,a._)("div",{class:"saturation-white"},null,-1))),fe=he((()=>(0,a._)("div",{class:"saturation-black"},null,-1))),ge=he((()=>(0,a._)("div",{class:"saturation-circle"},null,-1))),we=[ge];var me=(0,a.aZ)({name:"Saturation",props:{value:{type:Object,required:!0},hue:{type:Number,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,o=(0,a.Fl)((()=>{const e=ve()(n.value).toHsv();return-1!==n.hue&&(e.h=n.hue),e})),l=(0,a.Fl)((()=>`hsl(${o.value.h}, 100%, 50%)`)),r=(0,a.Fl)((()=>-100*o.value.v+1+100+"%")),u=(0,a.Fl)((()=>100*o.value.s+"%")),c=(0,de.throttle)((function(e){t("colorChange",e)}),20,{leading:!0,trailing:!1}),v=(0,i.iH)(),d=e=>{if(e.preventDefault(),!v.value)return;const t=v.value.clientWidth,n=v.value.clientHeight,l=v.value.getBoundingClientRect().left+window.pageXOffset,a=v.value.getBoundingClientRect().top+window.pageYOffset,i=(0,de.clamp)(e.pageX-l,0,t),s=(0,de.clamp)(e.pageY-a,0,n),r=i/t,u=(0,de.clamp)(-s/n+1,0,1);c({h:o.value.h,s:r,v:u,a:o.value.a})},h=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",h)},p=e=>{d(e),window.addEventListener("mousemove",d),window.addEventListener("mouseup",h)};return(0,a.Ah)(h),(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"saturation",ref_key:"saturationRef",ref:v,style:(0,s.j5)({background:(0,i.SU)(l)}),onMousedown:t[0]||(t[0]=e=>p(e))},[pe,fe,(0,a._)("div",{class:"saturation-pointer",style:(0,s.j5)({top:(0,i.SU)(r),left:(0,i.SU)(u)})},we,4)],36))}});const ye=(0,d.Z)(me,[["__scopeId","data-v-0d8140ba"]]);var be=ye,ke=(0,a.aZ)({name:"Checkboard",props:{size:{type:Number,default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},setup(e){const t=e,n={},o=(e,t,n)=>{const o=document.createElement("canvas");o.width=o.height=2*n;const l=o.getContext("2d");return l?(l.fillStyle=e,l.fillRect(0,0,o.width,o.height),l.fillStyle=t,l.fillRect(0,0,n,n),l.translate(n,n),l.fillRect(0,0,n,n),o.toDataURL()):null},l=(e,t,l)=>{const a=e+","+t+","+l;if(n[a])return n[a];const i=o(e,t,l);return n[a]=i,i},r=(0,a.Fl)((()=>{const e=l(t.white,t.grey,t.size);return{backgroundImage:`url(${e})`}}));return(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"checkerboard",style:(0,s.j5)((0,i.SU)(r))},null,4))}});const Ee=(0,d.Z)(ke,[["__scopeId","data-v-68741d31"]]);var xe=Ee;const Oe=e=>((0,a.dD)("data-v-1c8d77ce"),e=e(),(0,a.Cn)(),e),Se={class:"hue"},Ce=Oe((()=>(0,a._)("div",{class:"hue-picker"},null,-1))),_e=[Ce];var Me=(0,a.aZ)({name:"Hue",props:{value:{type:Object,required:!0},hue:{type:Number,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,o=(0,i.iH)(0),l=(0,i.iH)(""),r=(0,a.Fl)((()=>{const e=ve()(n.value).toHsl();return-1!==n.hue&&(e.h=n.hue),e})),u=(0,a.Fl)((()=>0===r.value.h&&"right"===l.value?"100%":100*r.value.h/360+"%"));(0,a.YP)((()=>n.value),(()=>{const e=ve()(n.value).toHsl(),t=0===e.s?n.hue:e.h;0!==t&&t-o.value>0&&(l.value="right"),0!==t&&t-o.value<0&&(l.value="left"),o.value=t}));const c=(0,i.iH)(),v=e=>{if(e.preventDefault(),!c.value)return;const o=c.value.clientWidth,l=c.value.getBoundingClientRect().left+window.pageXOffset,a=e.pageX-l;let i,s;a<0?i=0:a>o?i=360:(s=100*a/o,i=360*s/100),-1!==n.hue&&r.value.h===i||t("colorChange",{h:i,l:r.value.l,s:r.value.s,a:r.value.a})},d=()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",d)},h=e=>{v(e),window.addEventListener("mousemove",v),window.addEventListener("mouseup",d)};return(0,a.Ah)(d),(e,t)=>((0,a.wg)(),(0,a.iD)("div",Se,[(0,a._)("div",{class:"hue-container",ref_key:"hueRef",ref:c,onMousedown:t[0]||(t[0]=e=>h(e))},[(0,a._)("div",{class:"hue-pointer",style:(0,s.j5)({left:(0,i.SU)(u)})},_e,4)],544)]))}});const Re=(0,d.Z)(Me,[["__scopeId","data-v-1c8d77ce"]]);var Te=Re;const ze=e=>((0,a.dD)("data-v-d0628eb2"),e=e(),(0,a.Cn)(),e),Ae={class:"alpha"},Ue={class:"alpha-checkboard-wrap"},De=ze((()=>(0,a._)("div",{class:"alpha-picker"},null,-1))),Le=[De];var He=(0,a.aZ)({name:"Alpha",props:{value:{type:Object,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,o=(0,a.Fl)((()=>n.value)),l=(0,a.Fl)((()=>{const e=[o.value.r,o.value.g,o.value.b].join(",");return`linear-gradient(to right, rgba(${e}, 0) 0%, rgba(${e}, 1) 100%)`})),r=(0,i.iH)(),u=e=>{if(e.preventDefault(),!r.value)return;const n=r.value.clientWidth,l=r.value.getBoundingClientRect().left+window.pageXOffset,a=e.pageX-l;let i;i=a<0?0:a>n?1:Math.round(100*a/n)/100,o.value.a!==i&&t("colorChange",{r:o.value.r,g:o.value.g,b:o.value.b,a:i})},c=()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",c)},v=e=>{u(e),window.addEventListener("mousemove",u),window.addEventListener("mouseup",c)};return(0,a.Ah)(c),(e,t)=>((0,a.wg)(),(0,a.iD)("div",Ae,[(0,a._)("div",Ue,[(0,a.Wm)(xe)]),(0,a._)("div",{class:"alpha-gradient",style:(0,s.j5)({background:(0,i.SU)(l)})},null,4),(0,a._)("div",{class:"alpha-container",ref_key:"alphaRef",ref:r,onMousedown:t[0]||(t[0]=e=>v(e))},[(0,a._)("div",{class:"alpha-pointer",style:(0,s.j5)({left:100*(0,i.SU)(o).a+"%"})},Le,4)],544)]))}});const We=(0,d.Z)(He,[["__scopeId","data-v-d0628eb2"]]);var Ne=We;const Pe={class:"editable-input"},Ye=["value"],je={class:"editable-input rgba-input"},Be=["value"];var Fe=(0,a.aZ)({name:"EditableInput",props:{value:{type:Object,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,o=(0,a.Fl)((()=>{let e="";return e=n.value.a<1?ve()(n.value).toHex8String().toUpperCase():ve()(n.value).toHexString().toUpperCase(),e.replace("#","")})),l=(0,a.Fl)((()=>ve()(n.value).toRgbString())),s=new RegExp("^[rR][gG][Bb][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){2}[\\s]*(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)[\\s]*[)]{1}$"),r=new RegExp("^[rR][gG][Bb][Aa][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){3}[\\s]*(1|1.0|0|0.[0-9])[\\s]*[)]{1}$"),u=e=>{const n=e.target.value;if(n.indexOf("rgb")>-1){const e=n.replace(/\s*/g,""),o=e.match(/[.\d]+/g);o&&(3===o.length&&null!==e.match(s)||4===o.length&&null!==e.match(r))&&t("colorChange",{r:Number(o[0]),g:Number(o[1]),b:Number(o[2]),a:o[3]?Number(o[3]):1})}},c=e=>{const n=e.target.value;n.length>=6&&t("colorChange",ve()(n).toRgb())};return(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",Pe,[(0,a._)("input",{class:"input-content",value:(0,i.SU)(o),onInput:t[0]||(t[0]=e=>c(e))},null,40,Ye)]),(0,a._)("div",je,[(0,a._)("input",{class:"input-content",value:(0,i.SU)(l),onInput:t[1]||(t[1]=e=>u(e))},null,40,Be)])],64))}});const Xe=(0,d.Z)(Fe,[["__scopeId","data-v-573ff628"]]);var Ze=Xe;const Ie="CTX_CLICK_OUTSIDE_HANDLER",qe=(e,t,n)=>{const o=n.value,l=t.composedPath(),a=l?l.indexOf(e)<0:!e.contains(t.target);a&&o(t)},Ve={mounted(e,t){e[Ie]=n=>qe(e,n,t),setTimeout((()=>{document.addEventListener("click",e[Ie])}),0)},unmounted(e){e[Ie]&&(document.removeEventListener("click",e[Ie]),delete e[Ie])}};var Ke=Ve;const Ge={class:"wb-color-picker"},Je=["onClick"],Qe={class:"picker-saturation-wrap"},$e={class:"picker-controls"},et={class:"picker-color-wrap"},tt={class:"picker-sliders"},nt={class:"picker-hue-wrap"},ot={class:"picker-alpha-wrap"},lt={class:"picker-field"},at={class:"picker-presets"},it=["onClick"],st={class:"picker-gradient-presets"},rt=["onClick"],ut={class:"picker-presets"},ct=["onClick"],vt={key:0,class:"recent-colors-title"},dt={class:"recent-colors"},ht=["onClick"];var pt=(0,a.aZ)({name:"index",props:{inputValue:{type:String,required:!0}},emits:["update"],setup(e,{emit:t}){const n=e,{inputValue:o}=(0,i.BK)(n),r=(0,i.iH)(["#000000","#f60000","#fff700","#0014ff","#00ff66"]),u=e=>{t("update",e)},c=(0,i.iH)(!1),v=(0,i.iH)(!1),d="RECENT_COLORS",h=[["#7f7f7f","#f2f2f2"],["#0d0d0d","#808080"],["#1c1a10","#ddd8c3"],["#0e243d","#c6d9f0"],["#233f5e","#dae5f0"],["#632623","#f2dbdb"],["#4d602c","#eaf1de"],["#3f3150","#e6e0ec"],["#1e5867","#d9eef3"],["#99490f","#fee9da"]],p=(e,t,n)=>{const o=ve()(e).toRgb(),l=ve()(t).toRgb(),a=(l.r-o.r)/n,i=(l.g-o.g)/n,s=(l.b-o.b)/n,r=[];for(let u=0;u<n;u++){const e=ve()({r:o.r+a*u,g:o.g+i*u,b:o.b+s*u}).toRgbString();r.push(e)}return r},f=(0,i.iH)(-1),g=(0,i.iH)([]),w=(0,i.Fl)({get(){return ve()(n.inputValue).toRgb()},set(e){const n=`rgba(${[e.r,e.g,e.b,e.a].join(",")})`;t("update",n)}}),m=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c"],y=["#c21401","#ff0000","#ffc12a","#ffff3a","#90cf5b","#00af57","#00afee","#0071be","#00215f","#72349d"],b=()=>{const e=[];for(const t of h)e.push(p(t[1],t[0],5));return e},k=b(),E=(0,i.Fl)((()=>`rgba(${[w.value.r,w.value.g,w.value.b,w.value.a].join(",")})`)),x=e=>{f.value=ve()(e).toHsl().h,t("update",e)},O=(0,de.debounce)((function(){const e=ve()(w.value).toRgbString();if(!g.value.includes(e)){g.value=[e,...g.value];const t=10;g.value.length>t&&(g.value=g.value.slice(0,t))}}),300,{trailing:!0});(0,a.bv)((()=>{const e=localStorage.getItem(d);e&&(g.value=JSON.parse(e))})),(0,a.YP)(g,(()=>{const e=JSON.stringify(g.value);localStorage.setItem(d,e)}));const S=e=>{"h"in e?(f.value=e.h,w.value=ve()(e).toRgb()):(f.value=ve()(e).toHsl().h,w.value=e),O()},C=()=>{c.value&&(v.value=!1,setTimeout((()=>{c.value=!1}),300))},_=()=>{c.value?C():(c.value=!0,v.value=!0)};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",Ge,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.value,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"wb-color-item",style:(0,s.j5)({backgroundColor:e}),key:e,onClick:t=>u(e)},[(0,i.SU)(o)===e?((0,a.wg)(),(0,a.j4)(ue,{key:0})):(0,a.kq)("",!0)],12,Je)))),128)),(0,a._)("div",{class:"wb-color-item wb-custom-color",style:(0,s.j5)({backgroundColor:(0,i.SU)(o)}),onClick:t[5]||(t[5]=(0,l.iM)((e=>_()),["stop"]))},[(0,a.Wm)(R),c.value?(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,s.C_)(["color-picker",v.value?"open":"close"]),onClick:t[4]||(t[4]=(0,l.iM)((()=>null),["stop"]))},[(0,a._)("div",Qe,[(0,a.Wm)(be,{value:(0,i.SU)(w),hue:f.value,onColorChange:t[0]||(t[0]=e=>S(e))},null,8,["value","hue"])]),(0,a._)("div",$e,[(0,a._)("div",et,[(0,a._)("div",{class:"picker-current-color",style:(0,s.j5)({background:(0,i.SU)(E)})},null,4),(0,a.Wm)(xe)]),(0,a._)("div",tt,[(0,a._)("div",nt,[(0,a.Wm)(Te,{value:(0,i.SU)(w),hue:f.value,onColorChange:t[1]||(t[1]=e=>S(e))},null,8,["value","hue"])]),(0,a._)("div",ot,[(0,a.Wm)(Ne,{value:(0,i.SU)(w),onColorChange:t[2]||(t[2]=e=>S(e))},null,8,["value"])])])]),(0,a._)("div",lt,[(0,a.Wm)(Ze,{value:(0,i.SU)(w),onColorChange:t[3]||(t[3]=e=>S(e))},null,8,["value"])]),(0,a._)("div",at,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(m,(e=>(0,a._)("div",{class:"picker-presets-color",key:e,style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,it))),64))]),(0,a._)("div",st,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,i.SU)(k),((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"picker-gradient-col",key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"picker-gradient-color",key:e,style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,rt)))),128))])))),128))]),(0,a._)("div",ut,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(y,(e=>(0,a._)("div",{key:e,class:"picker-presets-color",style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,ct))),64))]),g.value.length?((0,a.wg)(),(0,a.iD)("div",vt," 最近使用： ")):(0,a.kq)("",!0),(0,a._)("div",dt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.value,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"picker-presets-color",style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,ht)))),128))])],2)),[[(0,i.SU)(Ke),()=>C()]]):(0,a.kq)("",!0)],4)]))}});const ft=(0,d.Z)(pt,[["__scopeId","data-v-68c050f6"]]);var gt=ft;const wt={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},mt=(0,a._)("path",{d:"M567.024534 149.331607m60.339779 60.339778l199.422968 199.422969q60.339779 60.339779 0 120.679557l-184.941421 184.941422q-60.339779 60.339779-120.679558 0l-199.422968-199.422969q-60.339779-60.339779 0-120.679557l184.941421-184.941422q60.339779-60.339779 120.679558 0Z"},null,-1),yt=(0,a._)("path",{d:"M557.653333 256l211.2 213.333333-302.08 298.666667H346.88l-151.466667-151.466667L557.653333 256m0-85.333333a85.333333 85.333333 0 0 0-60.586666 24.746666L135.253333 554.666667a85.333333 85.333333 0 0 0 0 120.746666L311.466667 853.333333h190.293333l327.253333-327.253333a85.333333 85.333333 0 0 0 0-120.746667l-211.2-211.2A85.333333 85.333333 0 0 0 557.653333 170.666667z"},null,-1),bt=(0,a._)("path",{d:"M332.8 768m42.666667 0l469.333333 0q42.666667 0 42.666667 42.666667l0 0q0 42.666667-42.666667 42.666666l-469.333333 0q-42.666667 0-42.666667-42.666666l0 0q0-42.666667 42.666667-42.666667Z"},null,-1),kt=[mt,yt,bt];function Et(e,t){return(0,a.wg)(),(0,a.iD)("svg",wt,kt)}const xt={},Ot=(0,d.Z)(xt,[["render",Et]]);var St=Ot;const Ct={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_t=(0,a._)("path",{d:"M529.3 381.5h-4.9l-0.6-110.3c0-40.9-33.9-57-62.8-33.7L192.1 453.8c-28.9 23.2-28.9 61.2 0.1 84.4L459 752.3c28.9 23.2 68.7-0.4 68.7-34.9V602h26.1c116.7 0 205.7 50.4 260.2 147.7 10.7 17.7 22 13.8 22 0-2.4-173.3-143-368.1-311.6-368.1h4.9z m-5-0.1"},null,-1),Mt=[_t];function Rt(e,t){return(0,a.wg)(),(0,a.iD)("svg",Ct,Mt)}const Tt={},zt=(0,d.Z)(Tt,[["render",Rt]]);var At=zt;const Ut=e=>((0,a.dD)("data-v-7e6eedc8"),e=e(),(0,a.Cn)(),e),Dt={class:"wb-toolbar"},Lt={class:"wb-control"},Ht={class:"wb-tool"},Wt={class:"wb-setting"},Nt={class:"wb-setting-line"},Pt=Ut((()=>(0,a._)("div",{class:"wb-setting-label"},"颜色",-1))),Yt={class:"wb-setting-value"},jt={class:"wb-setting-line"},Bt=Ut((()=>(0,a._)("div",{class:"wb-setting-label"},"粗细",-1))),Ft={class:"wb-setting-value"};var Xt=(0,a.aZ)({name:"Toolbar",props:{optionType:{type:String,requried:!0},lineWidth:{type:Number,required:!0},strokeColor:{type:String,required:!0},zoom:{type:Number,required:!0},snapshotCursor:{type:Number,required:!0},snapshotKeys:{type:Array,required:!0}},emits:["update:optionType","update:lineWidth","update:strokeColor","update:zoom","zoomChange","clear","redo","undo"],setup(e,{emit:t}){const n=e,{optionType:l,strokeColor:r,lineWidth:u,zoom:c}=(0,i.BK)(n),v=(0,i.iH)(!0),d=()=>{t("undo")},h=()=>{t("redo")},p=e=>{if(e===o.CLEAR)return t("clear");t("update:optionType",e)},g=e=>{t("update:strokeColor",e)},w=e=>{if("zoom"===e){if(.1===c.value)return;const e=c.value,n=Number((e-.05<.1?.1:e-.05).toFixed(2));return t("update:zoom",n),void t("zoomChange",n,e)}1!==u.value&&t("update:lineWidth",5===u.value?1:u.value-5)},m=e=>{if("zoom"===e){const e=c.value,n=Number((c.value+.05).toFixed(2));return t("update:zoom",n),void t("zoomChange",n,e)}t("update:lineWidth",1===u.value?5:u.value+5)},y=e=>{t("update:lineWidth",e)};return(t,n)=>((0,a.wg)(),(0,a.iD)("div",Dt,[(0,a._)("div",Lt,[(0,a.Wm)(K,{disabled:"",inputValue:Math.round(100*(0,i.SU)(c))+"%",onReduce:n[0]||(n[0]=e=>w("zoom")),onAdd:n[1]||(n[1]=e=>m("zoom"))},null,8,["inputValue"]),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn revoke",-1===e.snapshotCursor&&"disabled"]),onClick:n[2]||(n[2]=e=>d())},[(0,a.Wm)(At)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn recover",e.snapshotCursor===e.snapshotKeys.length-1&&"disabled"]),onClick:n[3]||(n[3]=e=>h())},[(0,a.Wm)(At)],2)]),(0,a._)("div",Ht,[(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn",(0,i.SU)(l)===(0,i.SU)(o).MOUSE&&"active"]),onClick:n[4]||(n[4]=e=>p((0,i.SU)(o).MOUSE))},[(0,a.Wm)(f)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn",(0,i.SU)(l)===(0,i.SU)(o).PEN&&"active"]),onClick:n[5]||(n[5]=e=>p((0,i.SU)(o).PEN))},[(0,a.Wm)(E)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn eraser-btn",(0,i.SU)(l)===(0,i.SU)(o).ERASER&&"active"]),onClick:n[6]||(n[6]=e=>p((0,i.SU)(o).ERASER))},[(0,a.Wm)(St)],2),(0,a._)("div",{class:"wb-tool-btn clear-btn",onClick:n[7]||(n[7]=e=>p((0,i.SU)(o).CLEAR))},[(0,a.Wm)(ne)])]),(0,a._)("div",Wt,[(0,a._)("div",{class:(0,s.C_)(["wb-setting-card",v.value?"open":"close"])},[(0,a._)("div",Nt,[Pt,(0,a._)("div",Yt,[(0,a.Wm)(gt,{inputValue:(0,i.SU)(r),onUpdate:n[8]||(n[8]=e=>g(e))},null,8,["inputValue"])])]),(0,a._)("div",jt,[Bt,(0,a._)("div",Ft,[(0,a.Wm)(K,{inputValue:(0,i.SU)(u),onReduce:n[9]||(n[9]=e=>w("lineWidth")),onAdd:n[10]||(n[10]=e=>m("lineWidth")),onInput:n[11]||(n[11]=e=>y(e))},null,8,["inputValue"])])])],2),(0,a._)("div",{class:"wb-setting-btn",onClick:n[12]||(n[12]=e=>v.value=!v.value)},[(0,a.Wm)(R,{class:(0,s.C_)(!v.value&&"close")},null,8,["class"])])])]))}});const Zt=(0,d.Z)(Xt,[["__scopeId","data-v-7e6eedc8"]]);var It=Zt,qt=n(4290);const Vt=e=>JSON.parse(JSON.stringify(e)),Kt=(e=10)=>{const t="_0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=t.length;let o="";for(let l=0;l<e;l++){const e=Math.floor(Math.random()*n);o+=t[e]}return o},Gt=(e,t)=>{const n=e instanceof TouchEvent?e.targetTouches[0].clientX:e.clientX,o=e instanceof TouchEvent?e.targetTouches[0].clientY:e.clientY;return{x:(n-t.offsetX)/t.zoom-t.scrollX,y:(o-t.offsetY)/t.zoom-t.scrollY}},Jt=(e,t)=>{const n=e instanceof TouchEvent?e.targetTouches[0].clientX:e.clientX,o=e instanceof TouchEvent?e.targetTouches[0].clientY:e.clientY;return{x:(n-t.offsetX)/t.zoom,y:(o-t.offsetY)/t.zoom}},Qt=(e,t,n,o,l)=>{const a=e-n.offsetX,i=t-n.offsetY,s=n.scrollX+(a-a/l),r=n.scrollY+(i-i/l),u=-(a-a/o),c=-(i-i/o);return{scrollX:s+u,scrollY:r+c}},$t=e=>{let t=1/0,n=1/0,o=-1/0,l=-1/0;for(const[a,i]of e)t=Math.min(t,a),n=Math.min(n,i),o=Math.max(o,a),l=Math.max(l,i);return[t,n,o,l]},en=e=>{const[t,n,o,l]=tn(e),a=(t+o)/2,i=(n+l)/2;return{cx:a,cy:i,minX:t,minY:n,maxX:o,maxY:l}},tn=e=>{if(e.type===o.PEN){const[t,n,o,l]=$t(e.points);return[t+e.x,n+e.y,o+e.x,l+e.y]}return[e.x,e.y,e.x+e.width,e.y+e.height]},nn=e=>{let t=null,n=null,o=null;const l=(...l)=>{n=l,o=e,null===t&&(t=window.requestAnimationFrame((()=>{t=null,n=null,o=null,e(...l)})))};return l.flush=()=>{if(null!==t&&(cancelAnimationFrame(t),t=null),n){const e=n,t=o;n=null,o=null,null!==t&&t(...e)}},l.cancel=()=>{n=null,o=null,null!==t&&(cancelAnimationFrame(t),t=null)},l},on=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function ln(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const an=(e,t)=>{const n={simulatePressure:!0,size:t,thinning:.6,smoothing:.5,streamline:.5,easing:e=>Math.sin(e*Math.PI/2),last:!1},o=(0,qt.ZP)(e,n),l=o.length-1,a=o.reduce(((e,t,n,o)=>(n===l?e.push(t,ln(t,o[0]),"L",o[0],"Z"):e.push(t,ln(t,o[n+1])),e)),["M",o[0],"Q"]).join(" ").replace(on,"$1"),i=new Path2D(a);return i},sn=(e,t)=>e[0]*t[1]-e[1]*t[0],rn=(e,t,n,o)=>{for(const l of o){const[o,a,i,s]=$t(l.points);if(!(l.x+o>Math.max(e[0],t)&&l.y+a>Math.max(e[1],n)||l.x+i<Math.min(e[0],t)&&l.y+s<Math.min(e[1],n))&&!l.isDelete){if(i-o<5&&s-a<5||2===l.points.length){const e=Math.hypot(t-l.x,n-l.y);if(e<5)return l.isDelete=!0}for(let o=0;o<l.points.length-1;o++){const a=[l.points[o][0]+l.x,l.points[o][1]+l.y],i=[l.points[o+1][0]+l.x,l.points[o+1][1]+l.y],s=e,r=[t,n],u=[i[0]-a[0],i[1]-a[1]],c=[s[0]-a[0],s[1]-a[1]],v=[r[0]-a[0],r[1]-a[1]],d=[a[0]-s[0],a[1]-s[1]],h=[i[0]-s[0],i[1]-s[1]],p=[r[0]-s[0],r[1]-s[1]];if(-1===Math.sign(sn(c,u)*sn(v,u))&&-1===Math.sign(sn(d,p)*sn(h,p))){l.isDelete=!0;break}}}}},un=(e,t,n,o,l)=>{const[a,i,s,r]=cn(t,n,o,l);return e.filter((e=>{const[t,n,o,l]=tn(e);return o>a&&l>i&&t<s&&n<r}))},cn=(e,t,n,o)=>[0-e,0-t,n-e,o-t],vn=(e,t,n,o,l)=>{const a=5*t;let i;for(const s of e){const[e,t,r,u]=tn(s),c=(e+r)/2,v=(t+u)/2,[d,h]=mn(n,o,c,v,-s.angle);if(d>e&&d<r&&h>t&&h<u){const e={x:d-s.x,y:h-s.y};if(l&&l.id===s.id){i=l;break}for(let t=0;t<s.points.length-1;t++){const n=s.points[t],o=s.points[t+1],l=Math.hypot(n[0]-e.x,n[1]-e.y),r=Math.hypot(o[0]-e.x,o[1]-e.y),u=Math.hypot(n[0]-o[0],n[1]-o[1]);if(l<a||r<a||l+r-u<a){i=s;break}}if(i)break}}return i?Vt(i):void 0},dn=(e,t,n,o,l,a)=>{const i=e-l-a,s=e+n+l,r=(s+i)/2,u=t-l-a,c=t+o+l,v=(c+u)/2,d=[i,u,a,a],h=[i,v,a,a],p=[i,c,a,a],f=[r,u,a,a],g=[r,c,a,a],w=[s,u,a,a],m=[s,v,a,a],y=[s,c,a,a],b=[r,u-2*a,a,a];return{LEFT_TOP:d,LEFT:h,LEFT_BOTTOM:p,TOP:f,BOTTOM:g,RIGHT_TOP:w,RIGHT:m,RIGHT_BOTTOM:y,ANGLE:b}};var hn;(function(e){e["LEFT_TOP"]="nwse-resize",e["LEFT"]="ew-resize",e["LEFT_BOTTOM"]="nesw-resize",e["TOP"]="ns-resize",e["BOTTOM"]="ns-resize",e["RIGHT_TOP"]="nesw-resize",e["RIGHT"]="ew-resize",e["RIGHT_BOTTOM"]="nwse-resize",e["ANGLE"]="grabbing",e["MOVE"]="move"})(hn||(hn={}));const pn=(e,t,n,o,l)=>{const a=mn(e[0],e[1],n,o,-l),i=t[0],s=t[0]+t[2],r=t[1],u=t[1]+t[3];return a[0]>i&&a[0]<s&&a[1]>r&&a[1]<u},fn=(e,t,n)=>{const[o,l,a,i]=tn(t),s=a-o,r=i-l,u=4/n,c=8/n,v=dn(o,l,s,r,u,c),d=(o+a)/2,h=(l+i)/2;let p="";for(const f in v)if(pn(e,v[f],d,h,t.angle)){p=f;break}return p},gn=(e,t)=>t.find((t=>t.id===e)),wn=e=>e>=2*Math.PI?e-2*Math.PI:e,mn=(e,t,n,o,l)=>[(e-n)*Math.cos(l)-(t-o)*Math.sin(l)+n,(e-n)*Math.sin(l)+(t-o)*Math.cos(l)+o];var yn=(e,t)=>{const n=t=>(e.value.push(t),t),l=({x:e,y:l})=>n({id:Kt(),type:o.PEN,width:0,height:0,x:e,y:l,points:[[0,0]],angle:0,isDelete:!1,locked:!1,lineWidth:t.lineWidth,strokeColor:t.strokeColor});return{createPenElement:l}},bn=n(2482),kn=n(3831);const En="WHITE_BOARD_DB";class xn{constructor(){(0,bn.Z)(this,"db",void 0)}async init(){this.db||(this.db=await(0,kn.X3)(En,1,{upgrade(e){if(!e.objectStoreNames.contains("history")){const t=e.createObjectStore("history",{keyPath:"id",autoIncrement:!0});t.createIndex("id","id",{unique:!0})}}}))}async delete(e){for(const t of e)await(this.db?.transaction("history","readwrite").objectStore("history").delete(t))}async getData(e){return await(this.db?.transaction("history").objectStore("history").get(e))}async getAllKeys(){return await(this.db?.transaction("history").objectStore("history").getAllKeys())}async setData(e){this.db?.transaction("history","readwrite").objectStore("history").add({elements:JSON.parse(JSON.stringify(e))})}}var On=new xn,Sn=(e,t,n,o)=>{const l=(0,de.debounce)((async e=>{n.value<t.value.length-1&&await On["delete"](t.value.slice(n.value+1)),await On.setData(e),await a()}),300),a=async()=>{if(t.value=await On.getAllKeys(),!t.value||0===t.value.length)return{elements:[]};const o=await On.getData(t.value[t.value.length-1]);n.value=t.value.length-1,e.value=o.elements},i=async()=>{n.value>-1&&(n.value--,r())},s=()=>{n.value<t.value.length-1&&(n.value++,r())},r=async()=>{if(-1===n.value)return e.value=[],o&&o([]);const l=t.value[n.value],a=await On.getData(l);e.value=a.elements,o&&o(a.elements)};return{addHistorySnapshot:l,getHistorySnapshot:a,undo:i,redo:s}},Cn=(e,t,n,l)=>{const a=e=>{t.value&&(t.value.clearRect(...e),t.value.strokeRect(...e))},i=e=>{if(!t.value)return;t.value.save(),t.value.scale(window.devicePixelRatio*n.zoom,window.devicePixelRatio*n.zoom);const[o,l,i,s]=tn(e),r=i-o,u=s-l,c=4/n.zoom,v=8/n.zoom,d=4/n.zoom,h=(o+i)/2+n.scrollX,p=(l+s)/2+n.scrollY;t.value.translate(h,p),t.value.rotate(e.angle),t.value.strokeStyle="#333",t.value.lineWidth=1/n.zoom,t.value.setLineDash([v,d]),t.value.strokeRect(-r/2-c,-u/2-c,r+2*c,u+2*c);const f=dn(-r/2,-u/2,r,u,c,v);t.value.setLineDash([0,0]);for(const t in f)a(f[t]);t.value.restore()},s=e=>{if(e.points.length<2||!t.value)return;const[o,l,a,i]=tn(e),s=(o+a)/2+n.scrollX,r=(l+i)/2+n.scrollY,u=(a-o)/2-(e.x-o),c=(i-l)/2-(e.y-l);t.value.save(),t.value.scale(window.devicePixelRatio*n.zoom,window.devicePixelRatio*n.zoom),t.value.translate(s,r),t.value.rotate(e.angle),t.value.translate(-u,-c),t.value.fillStyle=e.strokeColor;const v=an(e.points,e.lineWidth);t.value.fill(v),t.value.stroke(),t.value.restore()},r=a=>{if(!e.value||!t.value)return;const r=e.value.width/n.zoom,u=e.value.height/n.zoom;t.value.clearRect(0,0,e.value.width,e.value.height);const c=un(a,n.scrollX,n.scrollY,r,u);if(c.forEach((e=>{if(!e.isDelete)switch(e.type){case o.PEN:s(e);break}})),l.value){const e=gn(l.value.id,a);e&&i(e)}};return{renderElements:r,renderPenElement:s}},_n=e=>{const t=(t,n)=>{const o=e.value.findIndex((e=>e.id===t.id));for(const e in n)t[e]=n[e];e.value[o]=t};return{updateElement:t}},Mn=(e,t,n,o,l)=>{const{updateElement:a}=_n(n),{renderElements:i}=Cn(e,t,o,l),s=(e,t,n,o,a,i)=>{const s=Math.abs(l.value.width),r=l.value.angle,u=[n-10,o],c=mn(u[0],u[1],n,o,r),v={x:e-n,y:t-o},d={x:c[0]-n,y:c[1]-o},h=Math.hypot(d.x,d.y),p=v.x*d.x+v.y*d.y,f=p/h*a,g=s-f,w=g/s,m=Math.abs(i)*(w-1),y=(g-s)/2;return{width:g,scaleX:w,ofx:m*Math.cos(r)*a,ofy:m*Math.sin(r)*a,cfx:y*Math.cos(r)*a,cfy:y*Math.sin(r)*a}},r=(e,t,n,o,a,i)=>{const s=Math.abs(l.value.height),r=l.value.angle,u=[n,o-10],c=mn(u[0],u[1],n,o,r),v={x:e-n,y:t-o},d={x:c[0]-n,y:c[1]-o},h=Math.hypot(d.x,d.y),p=v.x*d.x+v.y*d.y,f=p/h*a,g=s-f,w=g/s,m=Math.abs(i)*(w-1),y=(g-s)/2;return{height:g,scaleY:w,ofx:-m*Math.sin(r)*a,ofy:m*Math.cos(r)*a,cfx:-y*Math.sin(r)*a,cfy:y*Math.cos(r)*a}},u=(e,t,u)=>{if(!l.value||!e)return;const c=t-e[0],v=u-e[1],[d,h,p,f]=$t(l.value.points),g=gn(l.value.id,n.value);switch(hn[o.elementOption]){case hn.MOVE:g&&a(g,{x:l.value.x+c,y:l.value.y+v});break;case hn.ANGLE:if(g){const{cx:n,cy:o}=en(l.value),i=Math.atan2(e[1]-o,e[0]-n),s=Math.atan2(u-o,t-n)-i,r=wn(l.value.angle+s);a(g,{angle:r})}break;case hn.LEFT:case hn.LEFT_TOP:case hn.LEFT_BOTTOM:case hn.TOP:case hn.BOTTOM:case hn.RIGHT:case hn.RIGHT_TOP:case hn.RIGHT_BOTTOM:{const n=Vt(l.value.points),{cx:i,cy:c}=en(l.value),[v,w]=mn(l.value.x,l.value.y,i,c,l.value.angle),m={x:1,y:1},y={width:l.value.width,height:l.value.height},b={x:v,y:w},k={x:i,y:c};if(/LEFT/.test(o.elementOption)){const{width:n,ofx:o,ofy:l,cfx:a,cfy:i,scaleX:r}=s(t,u,e[0],e[1],-1,p);y.width=n,b.x=b.x+o,b.y=b.y+l,k.x=k.x+a,k.y=k.y+i,m.x=r}if(/RIGHT/.test(o.elementOption)){const{width:n,ofx:o,ofy:l,cfx:a,cfy:i,scaleX:r}=s(t,u,e[0],e[1],1,d);y.width=n,b.x=b.x+o,b.y=b.y+l,k.x=k.x+a,k.y=k.y+i,m.x=r}if(/TOP/.test(o.elementOption)){const{height:n,ofx:o,ofy:l,cfx:a,cfy:i,scaleY:s}=r(t,u,e[0],e[1],-1,f);y.height=n,b.x=b.x+o,b.y=b.y+l,k.x=k.x+a,k.y=k.y+i,m.y=s}if(/BOTTOM/.test(o.elementOption)){const{height:n,ofx:o,ofy:l,cfx:a,cfy:i,scaleY:s}=r(t,u,e[0],e[1],1,h);y.height=n,b.x=b.x+o,b.y=b.y+l,k.x=k.x+a,k.y=k.y+i,m.y=s}const[E,x]=mn(b.x,b.y,k.x,k.y,-l.value.angle);a(g,{width:y.width,height:y.height,points:n.map((e=>[e[0]*m.x,e[1]*m.y])),x:E,y:x});break}}i(n.value)};return{optionElement:u}},Rn=(e,t,n,l,a,i,s,r)=>{const{createPenElement:u}=yn(n,l),{updateElement:c}=_n(n),{renderElements:v}=Cn(e,t,l,r),{optionElement:d}=Mn(e,t,n,l,r),{addHistorySnapshot:h}=Sn(n,a,i);let p=null,f=null;const g=(e,t)=>{if(l.elementOption=s.value?"MOVE":"",r.value){const n=fn([e,t],r.value,l.zoom);n&&(l.elementOption=n)}},w=e=>{if(f&&l.isMoveOrScale){const{x:t,y:o}=Jt(e,l);l.scrollX+=t-f[0],l.scrollY+=o-f[1],f=[t,o],v(n.value)}},m=t=>{if("CANVAS"===t.target.tagName)if(l.isMoveOrScale){const{x:e,y:n}=Jt(t,l);f=[e,n]}else switch(l.optionType){case o.MOUSE:{const{x:o,y:a}=Gt(t,l);if(f=[o,a],r.value){if(l.elementOption="",s.value&&(l.elementOption="MOVE",r.value.id!==s.value.id&&(r.value=Vt(gn(s.value.id,n.value)))),!r.value)return;const e=fn([o,a],r.value,l.zoom);e&&(l.elementOption=e),l.elementOption&&(r.value=Vt(gn(r.value.id,n.value)),l.isElementOption=!0)}if(!l.isElementOption){const t=e.value.width/l.zoom,i=e.value.height/l.zoom,s=un(n.value,l.scrollX,l.scrollY,t,i);r.value=vn(s,l.zoom,o,a,r.value),r.value&&(l.elementOption="MOVE",l.isElementOption=!0)}v(n.value);break}case o.PEN:{const{x:e,y:n}=Gt(t,l);p=u({x:e,y:n}),l.isDrawing=!0;break}case o.ERASER:{const{x:e,y:n}=Gt(t,l);f=[e,n],l.isDrawing=!0;break}}},y=nn((t=>{if(l.isDrawing)switch(l.optionType){case o.MOUSE:break;case o.PEN:{if(!p)return;const{x:e,y:n}=Gt(t,l);b(e,n);break}case o.ERASER:{if(!f)return;const{x:o,y:a}=Gt(t,l),i=e.value.width/l.zoom,s=e.value.height/l.zoom,r=un(n.value,l.scrollX,l.scrollY,i,s);rn(f,o,a,r),v(n.value),f=[o,a];break}}else if(l.isMoveOrScale)w(t);else if(l.optionType===o.MOUSE){const{x:o,y:a}=Gt(t,l);if(l.isElementOption)return d(f,o,a),void(l.isRecordElementOption=!0);const i=e.value.width/l.zoom,u=e.value.height/l.zoom,c=un(n.value,l.scrollX,l.scrollY,i,u);s.value=vn(c,l.zoom,o,a,r.value),l.isElementOption||g(o,a)}})),b=(e,t)=>{if(p){switch(p.type){case o.PEN:{const n=p.points;c(p,{points:[...n,[e-p.x,t-p.y]]});break}}v(n.value)}},k=e=>{if(l.isDrawing)switch(l.optionType){case o.MOUSE:break;case o.PEN:{if(!p)return;const t=p.points;if(1===t.length)c(p,{points:[...t,[1e-4,1e-4]]});else{const{x:n,y:o}=Gt(e,l);c(p,{points:[...t,[n-p.x,o-p.y]]})}const[o,a,i,s]=$t(p.points);c(p,{width:i-o,height:s-a}),h(n.value),v(n.value);break}case o.ERASER:n.value=n.value.filter((e=>!e.isDelete)),h(n.value),v(n.value);break}else w(e);if(p=null,f=null,l.isDrawing=!1,l.isElementOption){r.value=Vt(gn(r.value.id,n.value));const{x:t,y:o}=Gt(e,l);g(t,o),l.isRecordElementOption&&h(n.value)}l.isElementOption=!1},E=e=>{"Meta"!==e.key&&"Control"!==e.key||(l.isMoveOrScale=!0)},x=e=>{"Meta"!==e.key&&"Control"!==e.key||(l.isMoveOrScale=!1)};return{handleDown:m,handleMove:y,handleUp:k,watchKeyUp:x,watchKeyDown:E}},Tn=(e,t)=>{const n=()=>({x:e.value.width/2,y:e.value.height/2}),o=(e,n,o,l)=>{const{scrollX:a,scrollY:i}=Qt(o,l,t,e,n);t.scrollX=a,t.scrollY=i},l=(e,n,l)=>{const a=e-t.offsetX,i=n-t.offsetY,s=Math.sign(l),r=10,u=Math.abs(l);let c=l;u>r&&(c=r*s);const v=t.zoom-c/100,d=t.zoom;t.zoom=v,o(v,d,a,i)};return{getWhiteBoardCenter:n,updateScroll:o,handleWeel:l}},zn=(e,t,n,o)=>{const l=()=>{e.value&&t.value&&(t.value.clearRect(0,0,e.value.width,e.value.height),n.value=[],o.lineWidth=5,o.scrollX=0,o.scrollY=0,o.zoom=1,o.strokeColor="#000000")};return{clearElements:l}};const An=["width","height"];var Un=(0,a.aZ)({name:"index",setup(e){const t=window.devicePixelRatio,n=(0,i.iH)(null),r=(0,i.iH)(null),u=(0,i.iH)(null),c=(0,i.iH)(0*t),v=(0,i.iH)(0*t),d=(0,i.iH)("0px"),h=(0,i.iH)("0px"),p=(0,i.iH)(-1),f=(0,i.iH)([]),g=(0,i.iH)(),w=(0,i.iH)(),m=(0,a.Fl)((()=>y.isMoveOrScale?"grabbing":y.elementOption?hn[y.elementOption]:{MOUSE:"default",PEN:"crosshair",ERASER:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAARRJREFUOE/dlDFLxEAQhd+BVouFZ3vlQuwSyI+5a7PBRkk6k9KzTOwStJFsWv0xgaQzkNLWszim0kL2OOFc9oKRYHFTz37Lm/dmJhi5JiPzcBjAOYDz7WheADz3jalP8oIxds85P3Zd90RBqqpad133SUSXAJ5M4H3AhWVZd1EUzYQQP96VZYkkSV7btr02QY1Axtgqz/NTz/OM6qSUCMNwRURneoMJOLdt+7Gu643MfeU4zrppmgt9pibgjRBiWRRFb0R934eUcgngdrfxX4CjSwZj7C3Lsqnu8Lc05XQQBO9ENP2NKapnE5s4jme608rhNE2HxWb7qwr2A+f8SAv2BxFdDQ32rpLRVu9Pl+0wztcg6V/VPW4Vw1FsawAAAABJRU5ErkJggg==') 10 10, auto"}[y.optionType])),y=(0,i.qj)({offsetX:0,offsetY:0,scrollX:0,scrollY:0,zoom:1,optionType:o.MOUSE,lineWidth:5,strokeColor:"#000000",isDrawing:!1,isMoveOrScale:!1,elementOption:"",isElementOption:!1,isRecordElementOption:!1}),b="ontouchstart"in window,k=(0,i.iH)([]),{handleDown:E,handleMove:x,handleUp:O,watchKeyDown:S,watchKeyUp:C}=Rn(r,u,k,y,f,p,g,w),{renderElements:_}=Cn(r,u,y,w),{updateScroll:M,handleWeel:R}=Tn(r,y),{clearElements:T}=zn(r,u,k,y),{getHistorySnapshot:z,undo:A,redo:U}=Sn(k,f,p,_),D=(e,t)=>{M(e,t,r.value.width/2,r.value.height/2),_(k.value)},L=(0,de.throttle)((e=>{(e.metaKey||e.ctrlKey)&&(R(e.pageX,e.pageY,e.deltaY),_(k.value))}),30);return(0,a.Y3)((async()=>{if(await On.init(),!r.value||!n.value)return;u.value=r.value.getContext("2d"),window.addEventListener("keydown",S),window.addEventListener("keyup",C),b?(window.addEventListener("touchstart",E),window.addEventListener("touchmove",x),window.addEventListener("touchend",O)):(window.addEventListener("pointerdown",E),window.addEventListener("pointermove",x),window.addEventListener("pointerup",O));const e=(0,de.throttle)((()=>{n.value&&u.value&&(c.value=n.value.clientWidth*t,v.value=n.value.clientHeight*t,d.value=n.value.clientWidth+"px",h.value=n.value.clientHeight+"px",u.value.scale(t,t),u.value.setTransform(1,0,0,1,0,0),u.value.save(),(0,a.Y3)((async()=>{await z(),_(k.value)})))}),100),o=new ResizeObserver(e);o.observe(n.value)})),(0,a.Ah)((()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",C),b?(window.removeEventListener("touchstart",E),window.removeEventListener("touchmove",x),window.removeEventListener("touchend",O)):(window.removeEventListener("pointerdown",E),window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",O))})),(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"white-board",ref_key:"whiteboard",ref:n},[(0,a._)("canvas",{ref_key:"canvas",ref:r,width:c.value,height:v.value,onMousewheel:t[0]||(t[0]=(0,l.iM)(((...e)=>(0,i.SU)(L)&&(0,i.SU)(L)(...e)),["prevent"])),style:(0,s.j5)({width:d.value,height:h.value,cursor:(0,i.SU)(m)})},null,44,An),(0,a.Wm)(It,{strokeColor:y.strokeColor,"onUpdate:strokeColor":t[1]||(t[1]=e=>y.strokeColor=e),optionType:y.optionType,"onUpdate:optionType":t[2]||(t[2]=e=>y.optionType=e),lineWidth:y.lineWidth,"onUpdate:lineWidth":t[3]||(t[3]=e=>y.lineWidth=e),zoom:y.zoom,"onUpdate:zoom":t[4]||(t[4]=e=>y.zoom=e),snapshotCursor:p.value,snapshotKeys:f.value,onUndo:(0,i.SU)(A),onRedo:(0,i.SU)(U),onZoomChange:D,onClear:(0,i.SU)(T)},null,8,["strokeColor","optionType","lineWidth","zoom","snapshotCursor","snapshotKeys","onUndo","onRedo","onClear"])],512))}});const Dn=Un;var Ln=Dn,Hn=(0,a.aZ)({name:"App",setup(e){return(e,t)=>((0,a.wg)(),(0,a.j4)(Ln))}});const Wn=Hn;var Nn=Wn,Pn=n(5431);(0,Pn.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,l.ri)(Nn).mount("#app")}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var a=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,function(){var e=[];n.O=function(t,o,l,a){if(!o){var i=1/0;for(c=0;c<e.length;c++){o=e[c][0],l=e[c][1],a=e[c][2];for(var s=!0,r=0;r<o.length;r++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[r])}))?o.splice(r--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var u=l();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,l,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var l,a,i=o[0],s=o[1],r=o[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(l in s)n.o(s,l)&&(n.m[l]=s[l]);if(r)var c=r(n)}for(t&&t(o);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},o=self["webpackChunkwhiteboard"]=self["webpackChunkwhiteboard"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(9208)}));o=n.O(o)})();
//# sourceMappingURL=app.ba40c755.js.map