(function(){"use strict";var e={7332:function(e,t,n){var l,o=n(9242),a=n(3396),i=n(4870),s=n(7139);(function(e){e["PEN"]="PEN",e["MOUSE"]="MOUSE",e["CLEAR"]="CLEAR",e["ERASER"]="ERASER"})(l||(l={}));const r={viewBox:"0 0 320 512"},u=(0,a._)("path",{d:"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"},null,-1),c=[u];function v(e,t){return(0,a.wg)(),(0,a.iD)("svg",r,c)}var d=n(89);const h={},p=(0,d.Z)(h,[["render",v]]);var f=p;const g={viewBox:"0 0 512 512"},w=(0,a._)("path",{fill:"currentColor",d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"},null,-1),m=[w];function y(e,t){return(0,a.wg)(),(0,a.iD)("svg",g,m)}const b={},E=(0,d.Z)(b,[["render",y]]);var k=E;const x={viewBox:"0 0 1024 1024"},_=(0,a._)("path",{d:"M904.533333 674.133333l-362.666666-362.666666c-17.066667-17.066667-42.666667-17.066667-59.733334 0l-362.666666 362.666666c-17.066667 17.066667-17.066667 42.666667 0 59.733334 17.066667 17.066667 42.666667 17.066667 59.733333 0L512 401.066667l332.8 332.8c8.533333 8.533333 19.2 12.8 29.866667 12.8s21.333333-4.266667 29.866666-12.8c17.066667-17.066667 17.066667-42.666667 0-59.733334z"},null,-1),O=[_];function S(e,t){return(0,a.wg)(),(0,a.iD)("svg",x,O)}const C={},M=(0,d.Z)(C,[["render",S]]);var R=M;const T={viewBox:"0 0 448 512"},z=(0,a._)("path",{fill:"currentColor",d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},null,-1),U=[z];function A(e,t){return(0,a.wg)(),(0,a.iD)("svg",T,U)}const D={},L=(0,d.Z)(D,[["render",A]]);var H=L;const W={viewBox:"0 0 448 512"},Z=(0,a._)("path",{fill:"currentColor",d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},null,-1),N=[Z];function P(e,t){return(0,a.wg)(),(0,a.iD)("svg",W,N)}const Y={},j=(0,d.Z)(Y,[["render",P]]);var B=j;const X={class:"wb-step"},F=["value"],I={key:1,class:"web-step-value-readonly"};var q=(0,a.aZ)({__name:"Step",props:{inputValue:{type:[String,Number],default:0},disabled:{type:Boolean,default:!1}},emits:["reduce","add","input"],setup(e,{emit:t}){const n=e,{inputValue:l,disabled:o}=(0,i.BK)(n),r=()=>t("reduce"),u=()=>t("add"),c=e=>{const n=Number(e.target.value);n<1&&(e.target.value="1"),t("input",n<1?1:n)};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",X,[(0,a._)("div",{class:"wb-step-btn",onClick:t[0]||(t[0]=e=>r())},[(0,a.Wm)(B)]),(0,i.SU)(o)?((0,a.wg)(),(0,a.iD)("div",I,(0,s.zw)((0,i.SU)(l)),1)):((0,a.wg)(),(0,a.iD)("input",{key:0,value:(0,i.SU)(l),type:"number",min:"1",onInput:t[1]||(t[1]=e=>c(e)),class:"wb-step-value"},null,40,F)),(0,a._)("div",{class:"wb-step-btn",onClick:t[2]||(t[2]=e=>u())},[(0,a.Wm)(H)])]))}});const V=(0,d.Z)(q,[["__scopeId","data-v-5d9424c5"]]);var K=V;const G={viewBox:"0 0 1024 1024"},J=(0,a._)("path",{d:"M433.664 250.88L773.12 590.336 599.466667 837.162667a42.666667 42.666667 0 0 1-65.066667 5.632l-61.333333-61.333334v-130.88h-130.858667L181.205333 489.6a42.666667 42.666667 0 0 1 5.632-65.066667l246.826667-173.632z m38.378667-26.986667l66.133333-46.528a42.666667 42.666667 0 0 1 54.72 4.714667l89.130667 89.152 93.781333-93.781333a21.333333 21.333333 0 0 1 30.165333 0l35.2 35.2a21.333333 21.333333 0 0 1 0 30.186666l-93.76 93.76 94.506667 94.506667a42.666667 42.666667 0 0 1 4.714667 54.72l-46.506667 66.133333-328.106667-328.064z"},null,-1),Q=[J];function $(e,t){return(0,a.wg)(),(0,a.iD)("svg",G,Q)}const ee={},te=(0,d.Z)(ee,[["render",$]]);var ne=te;n(7658);const le={viewBox:"0 0 1024 1024"},oe=(0,a._)("path",{d:"M892.064 261.888a31.936 31.936 0 0 0-45.216 1.472L421.664 717.248 201.216 532.032a32 32 0 1 0-41.152 48.992l243.648 204.704a31.872 31.872 0 0 0 20.576 7.488 31.808 31.808 0 0 0 23.36-10.112l445.888-475.968a32 32 0 0 0-1.472-45.248z"},null,-1),ae=[oe];function ie(e,t){return(0,a.wg)(),(0,a.iD)("svg",le,ae)}const se={},re=(0,d.Z)(se,[["render",ie]]);var ue=re,ce=n(5082),ve=n(4806);const de=e=>((0,a.dD)("data-v-0d8140ba"),e=e(),(0,a.Cn)(),e),he=de((()=>(0,a._)("div",{class:"saturation-white"},null,-1))),pe=de((()=>(0,a._)("div",{class:"saturation-black"},null,-1))),fe=de((()=>(0,a._)("div",{class:"saturation-circle"},null,-1))),ge=[fe];var we=(0,a.aZ)({__name:"Saturation",props:{value:{type:Object,required:!0},hue:{type:Number,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,l=(0,a.Fl)((()=>{const e=(0,ce.Z)(n.value).toHsv();return-1!==n.hue&&(e.h=n.hue),e})),o=(0,a.Fl)((()=>`hsl(${l.value.h}, 100%, 50%)`)),r=(0,a.Fl)((()=>-100*l.value.v+1+100+"%")),u=(0,a.Fl)((()=>100*l.value.s+"%")),c=(0,ve.throttle)((function(e){t("colorChange",e)}),20,{leading:!0,trailing:!1}),v=(0,i.iH)(),d=e=>{if(e.preventDefault(),!v.value)return;const t=v.value.clientWidth,n=v.value.clientHeight,o=v.value.getBoundingClientRect().left+window.pageXOffset,a=v.value.getBoundingClientRect().top+window.pageYOffset,i=(0,ve.clamp)(e.pageX-o,0,t),s=(0,ve.clamp)(e.pageY-a,0,n),r=i/t,u=(0,ve.clamp)(-s/n+1,0,1);c({h:l.value.h,s:r,v:u,a:l.value.a})},h=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",h)},p=e=>{d(e),window.addEventListener("mousemove",d),window.addEventListener("mouseup",h)};return(0,a.Ah)(h),(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"saturation",ref_key:"saturationRef",ref:v,style:(0,s.j5)({background:(0,i.SU)(o)}),onMousedown:t[0]||(t[0]=e=>p(e))},[he,pe,(0,a._)("div",{class:"saturation-pointer",style:(0,s.j5)({top:(0,i.SU)(r),left:(0,i.SU)(u)})},ge,4)],36))}});const me=(0,d.Z)(we,[["__scopeId","data-v-0d8140ba"]]);var ye=me,be=(0,a.aZ)({__name:"Checkboard",props:{size:{type:Number,default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},setup(e){const t=e,n={},l=(e,t,n)=>{const l=document.createElement("canvas");l.width=l.height=2*n;const o=l.getContext("2d");return o?(o.fillStyle=e,o.fillRect(0,0,l.width,l.height),o.fillStyle=t,o.fillRect(0,0,n,n),o.translate(n,n),o.fillRect(0,0,n,n),l.toDataURL()):null},o=(e,t,o)=>{const a=e+","+t+","+o;if(n[a])return n[a];const i=l(e,t,o);return n[a]=i,i},r=(0,a.Fl)((()=>{const e=o(t.white,t.grey,t.size);return{backgroundImage:`url(${e})`}}));return(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"checkerboard",style:(0,s.j5)((0,i.SU)(r))},null,4))}});const Ee=(0,d.Z)(be,[["__scopeId","data-v-68741d31"]]);var ke=Ee;const xe=e=>((0,a.dD)("data-v-1c8d77ce"),e=e(),(0,a.Cn)(),e),_e={class:"hue"},Oe=xe((()=>(0,a._)("div",{class:"hue-picker"},null,-1))),Se=[Oe];var Ce=(0,a.aZ)({__name:"Hue",props:{value:{type:Object,required:!0},hue:{type:Number,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,l=(0,i.iH)(0),o=(0,i.iH)(""),r=(0,a.Fl)((()=>{const e=(0,ce.Z)(n.value).toHsl();return-1!==n.hue&&(e.h=n.hue),e})),u=(0,a.Fl)((()=>0===r.value.h&&"right"===o.value?"100%":100*r.value.h/360+"%"));(0,a.YP)((()=>n.value),(()=>{const e=(0,ce.Z)(n.value).toHsl(),t=0===e.s?n.hue:e.h;0!==t&&t-l.value>0&&(o.value="right"),0!==t&&t-l.value<0&&(o.value="left"),l.value=t}));const c=(0,i.iH)(),v=e=>{if(e.preventDefault(),!c.value)return;const l=c.value.clientWidth,o=c.value.getBoundingClientRect().left+window.pageXOffset,a=e.pageX-o;let i,s;a<0?i=0:a>l?i=360:(s=100*a/l,i=360*s/100),-1!==n.hue&&r.value.h===i||t("colorChange",{h:i,l:r.value.l,s:r.value.s,a:r.value.a})},d=()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",d)},h=e=>{v(e),window.addEventListener("mousemove",v),window.addEventListener("mouseup",d)};return(0,a.Ah)(d),(e,t)=>((0,a.wg)(),(0,a.iD)("div",_e,[(0,a._)("div",{class:"hue-container",ref_key:"hueRef",ref:c,onMousedown:t[0]||(t[0]=e=>h(e))},[(0,a._)("div",{class:"hue-pointer",style:(0,s.j5)({left:(0,i.SU)(u)})},Se,4)],544)]))}});const Me=(0,d.Z)(Ce,[["__scopeId","data-v-1c8d77ce"]]);var Re=Me;const Te=e=>((0,a.dD)("data-v-d0628eb2"),e=e(),(0,a.Cn)(),e),ze={class:"alpha"},Ue={class:"alpha-checkboard-wrap"},Ae=Te((()=>(0,a._)("div",{class:"alpha-picker"},null,-1))),De=[Ae];var Le=(0,a.aZ)({__name:"Alpha",props:{value:{type:Object,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,l=(0,a.Fl)((()=>n.value)),o=(0,a.Fl)((()=>{const e=[l.value.r,l.value.g,l.value.b].join(",");return`linear-gradient(to right, rgba(${e}, 0) 0%, rgba(${e}, 1) 100%)`})),r=(0,i.iH)(),u=e=>{if(e.preventDefault(),!r.value)return;const n=r.value.clientWidth,o=r.value.getBoundingClientRect().left+window.pageXOffset,a=e.pageX-o;let i;i=a<0?0:a>n?1:Math.round(100*a/n)/100,l.value.a!==i&&t("colorChange",{r:l.value.r,g:l.value.g,b:l.value.b,a:i})},c=()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",c)},v=e=>{u(e),window.addEventListener("mousemove",u),window.addEventListener("mouseup",c)};return(0,a.Ah)(c),(e,t)=>((0,a.wg)(),(0,a.iD)("div",ze,[(0,a._)("div",Ue,[(0,a.Wm)(ke)]),(0,a._)("div",{class:"alpha-gradient",style:(0,s.j5)({background:(0,i.SU)(o)})},null,4),(0,a._)("div",{class:"alpha-container",ref_key:"alphaRef",ref:r,onMousedown:t[0]||(t[0]=e=>v(e))},[(0,a._)("div",{class:"alpha-pointer",style:(0,s.j5)({left:100*(0,i.SU)(l).a+"%"})},De,4)],544)]))}});const He=(0,d.Z)(Le,[["__scopeId","data-v-d0628eb2"]]);var We=He;const Ze={class:"editable-input"},Ne=["value"],Pe={class:"editable-input rgba-input"},Ye=["value"];var je=(0,a.aZ)({__name:"EditableInput",props:{value:{type:Object,required:!0}},emits:["colorChange"],setup(e,{emit:t}){const n=e,l=(0,a.Fl)((()=>{let e="";return e=n.value.a<1?(0,ce.Z)(n.value).toHex8String().toUpperCase():(0,ce.Z)(n.value).toHexString().toUpperCase(),e.replace("#","")})),o=(0,a.Fl)((()=>(0,ce.Z)(n.value).toRgbString())),s=new RegExp("^[rR][gG][Bb][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){2}[\\s]*(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)[\\s]*[)]{1}$"),r=new RegExp("^[rR][gG][Bb][Aa][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){3}[\\s]*(1|1.0|0|0.[0-9])[\\s]*[)]{1}$"),u=e=>{const n=e.target.value;if(n.indexOf("rgb")>-1){const e=n.replace(/\s*/g,""),l=e.match(/[.\d]+/g);l&&(3===l.length&&null!==e.match(s)||4===l.length&&null!==e.match(r))&&t("colorChange",{r:Number(l[0]),g:Number(l[1]),b:Number(l[2]),a:l[3]?Number(l[3]):1})}},c=e=>{const n=e.target.value;n.length>=6&&t("colorChange",(0,ce.Z)(n).toRgb())};return(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",Ze,[(0,a._)("input",{class:"input-content",value:(0,i.SU)(l),onInput:t[0]||(t[0]=e=>c(e))},null,40,Ne)]),(0,a._)("div",Pe,[(0,a._)("input",{class:"input-content",value:(0,i.SU)(o),onInput:t[1]||(t[1]=e=>u(e))},null,40,Ye)])],64))}});const Be=(0,d.Z)(je,[["__scopeId","data-v-573ff628"]]);var Xe=Be;const Fe="CTX_CLICK_OUTSIDE_HANDLER",Ie=(e,t,n)=>{const l=n.value,o=t.composedPath(),a=o?o.indexOf(e)<0:!e.contains(t.target);a&&l(t)},qe={mounted(e,t){e[Fe]=n=>Ie(e,n,t),setTimeout((()=>{document.addEventListener("click",e[Fe])}),0)},unmounted(e){e[Fe]&&(document.removeEventListener("click",e[Fe]),delete e[Fe])}};var Ve=qe;const Ke={class:"wb-color-picker"},Ge=["onClick"],Je={class:"picker-saturation-wrap"},Qe={class:"picker-controls"},$e={class:"picker-color-wrap"},et={class:"picker-sliders"},tt={class:"picker-hue-wrap"},nt={class:"picker-alpha-wrap"},lt={class:"picker-field"},ot={class:"picker-presets"},at=["onClick"],it={class:"picker-gradient-presets"},st=["onClick"],rt={class:"picker-presets"},ut=["onClick"],ct={key:0,class:"recent-colors-title"},vt={class:"recent-colors"},dt=["onClick"];var ht=(0,a.aZ)({__name:"index",props:{inputValue:{type:String,required:!0}},emits:["update"],setup(e,{emit:t}){const n=e,{inputValue:l}=(0,i.BK)(n),r=(0,i.iH)(["#000000","#f60000","#fff700","#0014ff","#00ff66"]),u=e=>{t("update",e)},c=(0,i.iH)(!1),v=(0,i.iH)(!1),d="RECENT_COLORS",h=[["#7f7f7f","#f2f2f2"],["#0d0d0d","#808080"],["#1c1a10","#ddd8c3"],["#0e243d","#c6d9f0"],["#233f5e","#dae5f0"],["#632623","#f2dbdb"],["#4d602c","#eaf1de"],["#3f3150","#e6e0ec"],["#1e5867","#d9eef3"],["#99490f","#fee9da"]],p=(e,t,n)=>{const l=(0,ce.Z)(e).toRgb(),o=(0,ce.Z)(t).toRgb(),a=(o.r-l.r)/n,i=(o.g-l.g)/n,s=(o.b-l.b)/n,r=[];for(let u=0;u<n;u++){const e=(0,ce.Z)({r:l.r+a*u,g:l.g+i*u,b:l.b+s*u}).toRgbString();r.push(e)}return r},f=(0,i.iH)(-1),g=(0,i.iH)([]),w=(0,i.Fl)({get(){return(0,ce.Z)(n.inputValue).toRgb()},set(e){const n=`rgba(${[e.r,e.g,e.b,e.a].join(",")})`;t("update",n)}}),m=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c"],y=["#c21401","#ff0000","#ffc12a","#ffff3a","#90cf5b","#00af57","#00afee","#0071be","#00215f","#72349d"],b=()=>{const e=[];for(const t of h)e.push(p(t[1],t[0],5));return e},E=b(),k=(0,i.Fl)((()=>`rgba(${[w.value.r,w.value.g,w.value.b,w.value.a].join(",")})`)),x=e=>{f.value=(0,ce.Z)(e).toHsl().h,t("update",e)},_=(0,ve.debounce)((function(){const e=(0,ce.Z)(w.value).toRgbString();if(!g.value.includes(e)){g.value=[e,...g.value];const t=10;g.value.length>t&&(g.value=g.value.slice(0,t))}}),300,{trailing:!0});(0,a.bv)((()=>{const e=localStorage.getItem(d);e&&(g.value=JSON.parse(e))})),(0,a.YP)(g,(()=>{const e=JSON.stringify(g.value);localStorage.setItem(d,e)}));const O=e=>{"h"in e?(f.value=e.h,w.value=(0,ce.Z)(e).toRgb()):(f.value=(0,ce.Z)(e).toHsl().h,w.value=e),_()},S=()=>{c.value&&(v.value=!1,setTimeout((()=>{c.value=!1}),300))},C=()=>{c.value?S():(c.value=!0,v.value=!0)};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",Ke,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.value,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"wb-color-item",style:(0,s.j5)({backgroundColor:e}),key:e,onClick:t=>u(e)},[(0,i.SU)(l)===e?((0,a.wg)(),(0,a.j4)(ue,{key:0})):(0,a.kq)("",!0)],12,Ge)))),128)),(0,a._)("div",{class:"wb-color-item wb-custom-color",style:(0,s.j5)({backgroundColor:(0,i.SU)(l)}),onClick:t[5]||(t[5]=(0,o.iM)((e=>C()),["stop"]))},[(0,a.Wm)(R),c.value?(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,s.C_)(["color-picker",v.value?"open":"close"]),onClick:t[4]||(t[4]=(0,o.iM)((()=>null),["stop"]))},[(0,a._)("div",Je,[(0,a.Wm)(ye,{value:(0,i.SU)(w),hue:f.value,onColorChange:t[0]||(t[0]=e=>O(e))},null,8,["value","hue"])]),(0,a._)("div",Qe,[(0,a._)("div",$e,[(0,a._)("div",{class:"picker-current-color",style:(0,s.j5)({background:(0,i.SU)(k)})},null,4),(0,a.Wm)(ke)]),(0,a._)("div",et,[(0,a._)("div",tt,[(0,a.Wm)(Re,{value:(0,i.SU)(w),hue:f.value,onColorChange:t[1]||(t[1]=e=>O(e))},null,8,["value","hue"])]),(0,a._)("div",nt,[(0,a.Wm)(We,{value:(0,i.SU)(w),onColorChange:t[2]||(t[2]=e=>O(e))},null,8,["value"])])])]),(0,a._)("div",lt,[(0,a.Wm)(Xe,{value:(0,i.SU)(w),onColorChange:t[3]||(t[3]=e=>O(e))},null,8,["value"])]),(0,a._)("div",ot,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(m,(e=>(0,a._)("div",{class:"picker-presets-color",key:e,style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,at))),64))]),(0,a._)("div",it,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,i.SU)(E),((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"picker-gradient-col",key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"picker-gradient-color",key:e,style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,st)))),128))])))),128))]),(0,a._)("div",rt,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(y,(e=>(0,a._)("div",{key:e,class:"picker-presets-color",style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,ut))),64))]),g.value.length?((0,a.wg)(),(0,a.iD)("div",ct," 最近使用： ")):(0,a.kq)("",!0),(0,a._)("div",vt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.value,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"picker-presets-color",style:(0,s.j5)({background:e}),onClick:t=>x(e)},null,12,dt)))),128))])],2)),[[(0,i.SU)(Ve),()=>S()]]):(0,a.kq)("",!0)],4)]))}});const pt=(0,d.Z)(ht,[["__scopeId","data-v-68c050f6"]]);var ft=pt;const gt={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},wt=(0,a._)("path",{d:"M567.024534 149.331607m60.339779 60.339778l199.422968 199.422969q60.339779 60.339779 0 120.679557l-184.941421 184.941422q-60.339779 60.339779-120.679558 0l-199.422968-199.422969q-60.339779-60.339779 0-120.679557l184.941421-184.941422q60.339779-60.339779 120.679558 0Z"},null,-1),mt=(0,a._)("path",{d:"M557.653333 256l211.2 213.333333-302.08 298.666667H346.88l-151.466667-151.466667L557.653333 256m0-85.333333a85.333333 85.333333 0 0 0-60.586666 24.746666L135.253333 554.666667a85.333333 85.333333 0 0 0 0 120.746666L311.466667 853.333333h190.293333l327.253333-327.253333a85.333333 85.333333 0 0 0 0-120.746667l-211.2-211.2A85.333333 85.333333 0 0 0 557.653333 170.666667z"},null,-1),yt=(0,a._)("path",{d:"M332.8 768m42.666667 0l469.333333 0q42.666667 0 42.666667 42.666667l0 0q0 42.666667-42.666667 42.666666l-469.333333 0q-42.666667 0-42.666667-42.666666l0 0q0-42.666667 42.666667-42.666667Z"},null,-1),bt=[wt,mt,yt];function Et(e,t){return(0,a.wg)(),(0,a.iD)("svg",gt,bt)}const kt={},xt=(0,d.Z)(kt,[["render",Et]]);var _t=xt;const Ot={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},St=(0,a._)("path",{d:"M529.3 381.5h-4.9l-0.6-110.3c0-40.9-33.9-57-62.8-33.7L192.1 453.8c-28.9 23.2-28.9 61.2 0.1 84.4L459 752.3c28.9 23.2 68.7-0.4 68.7-34.9V602h26.1c116.7 0 205.7 50.4 260.2 147.7 10.7 17.7 22 13.8 22 0-2.4-173.3-143-368.1-311.6-368.1h4.9z m-5-0.1"},null,-1),Ct=[St];function Mt(e,t){return(0,a.wg)(),(0,a.iD)("svg",Ot,Ct)}const Rt={},Tt=(0,d.Z)(Rt,[["render",Mt]]);var zt=Tt;const Ut=e=>((0,a.dD)("data-v-7e6eedc8"),e=e(),(0,a.Cn)(),e),At={class:"wb-toolbar"},Dt={class:"wb-control"},Lt={class:"wb-tool"},Ht={class:"wb-setting"},Wt={class:"wb-setting-line"},Zt=Ut((()=>(0,a._)("div",{class:"wb-setting-label"},"颜色",-1))),Nt={class:"wb-setting-value"},Pt={class:"wb-setting-line"},Yt=Ut((()=>(0,a._)("div",{class:"wb-setting-label"},"粗细",-1))),jt={class:"wb-setting-value"};var Bt=(0,a.aZ)({__name:"Toolbar",props:{optionType:{type:String,requried:!0},lineWidth:{type:Number,required:!0},strokeColor:{type:String,required:!0},zoom:{type:Number,required:!0},snapshotCursor:{type:Number,required:!0},snapshotKeys:{type:Array,required:!0}},emits:["update:optionType","update:lineWidth","update:strokeColor","update:zoom","zoomChange","clear","redo","undo"],setup(e,{emit:t}){const n=e,{optionType:o,strokeColor:r,lineWidth:u,zoom:c}=(0,i.BK)(n),v=(0,i.iH)(!0),d=()=>{t("undo")},h=()=>{t("redo")},p=e=>{if(e===l.CLEAR)return t("clear");t("update:optionType",e)},g=e=>{t("update:strokeColor",e)},w=e=>{if("zoom"===e){if(.1===c.value)return;const e=c.value,n=Number((e-.05<.1?.1:e-.05).toFixed(2));return t("update:zoom",n),void t("zoomChange",n,e)}1!==u.value&&t("update:lineWidth",5===u.value?1:u.value-5)},m=e=>{if("zoom"===e){const e=c.value,n=Number((c.value+.05).toFixed(2));return t("update:zoom",n),void t("zoomChange",n,e)}t("update:lineWidth",1===u.value?5:u.value+5)},y=e=>{t("update:lineWidth",e)};return(t,n)=>((0,a.wg)(),(0,a.iD)("div",At,[(0,a._)("div",Dt,[(0,a.Wm)(K,{disabled:"",inputValue:Math.round(100*(0,i.SU)(c))+"%",onReduce:n[0]||(n[0]=e=>w("zoom")),onAdd:n[1]||(n[1]=e=>m("zoom"))},null,8,["inputValue"]),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn revoke",-1===e.snapshotCursor&&"disabled"]),onClick:n[2]||(n[2]=e=>d())},[(0,a.Wm)(zt)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn recover",e.snapshotCursor===e.snapshotKeys.length-1&&"disabled"]),onClick:n[3]||(n[3]=e=>h())},[(0,a.Wm)(zt)],2)]),(0,a._)("div",Lt,[(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn",(0,i.SU)(o)===(0,i.SU)(l).MOUSE&&"active"]),onClick:n[4]||(n[4]=e=>p((0,i.SU)(l).MOUSE))},[(0,a.Wm)(f)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn",(0,i.SU)(o)===(0,i.SU)(l).PEN&&"active"]),onClick:n[5]||(n[5]=e=>p((0,i.SU)(l).PEN))},[(0,a.Wm)(k)],2),(0,a._)("div",{class:(0,s.C_)(["wb-tool-btn eraser-btn",(0,i.SU)(o)===(0,i.SU)(l).ERASER&&"active"]),onClick:n[6]||(n[6]=e=>p((0,i.SU)(l).ERASER))},[(0,a.Wm)(_t)],2),(0,a._)("div",{class:"wb-tool-btn clear-btn",onClick:n[7]||(n[7]=e=>p((0,i.SU)(l).CLEAR))},[(0,a.Wm)(ne)])]),(0,a._)("div",Ht,[(0,a._)("div",{class:(0,s.C_)(["wb-setting-card",v.value?"open":"close"])},[(0,a._)("div",Wt,[Zt,(0,a._)("div",Nt,[(0,a.Wm)(ft,{inputValue:(0,i.SU)(r),onUpdate:n[8]||(n[8]=e=>g(e))},null,8,["inputValue"])])]),(0,a._)("div",Pt,[Yt,(0,a._)("div",jt,[(0,a.Wm)(K,{inputValue:(0,i.SU)(u),onReduce:n[9]||(n[9]=e=>w("lineWidth")),onAdd:n[10]||(n[10]=e=>m("lineWidth")),onInput:n[11]||(n[11]=e=>y(e))},null,8,["inputValue"])])])],2),(0,a._)("div",{class:"wb-setting-btn",onClick:n[12]||(n[12]=e=>v.value=!v.value)},[(0,a.Wm)(R,{class:(0,s.C_)(!v.value&&"close")},null,8,["class"])])])]))}});const Xt=(0,d.Z)(Bt,[["__scopeId","data-v-7e6eedc8"]]);var Ft=Xt,It=n(4290);const qt=e=>JSON.parse(JSON.stringify(e)),Vt=(e=10)=>{const t="_0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=t.length;let l="";for(let o=0;o<e;o++){const e=Math.floor(Math.random()*n);l+=t[e]}return l},Kt=(e,t)=>{const n=e instanceof TouchEvent?e.targetTouches[0].clientX:e.clientX,l=e instanceof TouchEvent?e.targetTouches[0].clientY:e.clientY;return{x:(n-t.offsetX)/t.zoom-t.scrollX,y:(l-t.offsetY)/t.zoom-t.scrollY}},Gt=(e,t)=>{const n=e instanceof TouchEvent?e.targetTouches[0].clientX:e.clientX,l=e instanceof TouchEvent?e.targetTouches[0].clientY:e.clientY;return{x:(n-t.offsetX)/t.zoom,y:(l-t.offsetY)/t.zoom}},Jt=(e,t,n,l,o)=>{const a=e-n.offsetX,i=t-n.offsetY,s=n.scrollX+(a-a/o),r=n.scrollY+(i-i/o),u=-(a-a/l),c=-(i-i/l);return{scrollX:s+u,scrollY:r+c}},Qt=e=>{let t=1/0,n=1/0,l=-1/0,o=-1/0;for(const[a,i]of e)t=Math.min(t,a),n=Math.min(n,i),l=Math.max(l,a),o=Math.max(o,i);return[t,n,l,o]},$t=e=>{const[t,n,l,o]=en(e),a=(t+l)/2,i=(n+o)/2;return{cx:a,cy:i,minX:t,minY:n,maxX:l,maxY:o}},en=e=>{if(e.type===l.PEN){const[t,n,l,o]=Qt(e.points);return[t+e.x,n+e.y,l+e.x,o+e.y]}return[e.x,e.y,e.x+e.width,e.y+e.height]},tn=e=>{let t=null,n=null,l=null;const o=(...o)=>{n=o,l=e,null===t&&(t=window.requestAnimationFrame((()=>{t=null,n=null,l=null,e(...o)})))};return o.flush=()=>{if(null!==t&&(cancelAnimationFrame(t),t=null),n){const e=n,t=l;n=null,l=null,null!==t&&t(...e)}},o.cancel=()=>{n=null,l=null,null!==t&&(cancelAnimationFrame(t),t=null)},o},nn=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function ln(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const on=(e,t)=>{const n={simulatePressure:!0,size:t,thinning:.6,smoothing:.5,streamline:.5,easing:e=>Math.sin(e*Math.PI/2),last:!1},l=(0,It.ZP)(e,n),o=l.length-1,a=l.reduce(((e,t,n,l)=>(n===o?e.push(t,ln(t,l[0]),"L",l[0],"Z"):e.push(t,ln(t,l[n+1])),e)),["M",l[0],"Q"]).join(" ").replace(nn,"$1"),i=new Path2D(a);return i},an=(e,t)=>e[0]*t[1]-e[1]*t[0],sn=(e,t,n,l)=>{for(const o of l){const[l,a,i,s]=Qt(o.points);if(!(o.x+l>Math.max(e[0],t)&&o.y+a>Math.max(e[1],n)||o.x+i<Math.min(e[0],t)&&o.y+s<Math.min(e[1],n))&&!o.isDelete){if(i-l<5&&s-a<5||2===o.points.length){const e=Math.hypot(t-o.x,n-o.y);if(e<5)return o.isDelete=!0}for(let l=0;l<o.points.length-1;l++){const a=[o.points[l][0]+o.x,o.points[l][1]+o.y],i=[o.points[l+1][0]+o.x,o.points[l+1][1]+o.y],s=e,r=[t,n],u=[i[0]-a[0],i[1]-a[1]],c=[s[0]-a[0],s[1]-a[1]],v=[r[0]-a[0],r[1]-a[1]],d=[a[0]-s[0],a[1]-s[1]],h=[i[0]-s[0],i[1]-s[1]],p=[r[0]-s[0],r[1]-s[1]];if(-1===Math.sign(an(c,u)*an(v,u))&&-1===Math.sign(an(d,p)*an(h,p))){o.isDelete=!0;break}}}}},rn=(e,t,n,l,o)=>{const[a,i,s,r]=un(t,n,l,o);return e.filter((e=>{const[t,n,l,o]=en(e);return l>a&&o>i&&t<s&&n<r}))},un=(e,t,n,l)=>[0-e,0-t,n-e,l-t],cn=(e,t,n,l,o)=>{const a=5*t;let i;for(const s of e){const[e,t,r,u]=en(s),c=(e+r)/2,v=(t+u)/2,[d,h]=wn(n,l,c,v,-s.angle);if(d>e&&d<r&&h>t&&h<u){const e={x:d-s.x,y:h-s.y};if(o&&o.id===s.id){i=o;break}for(let t=0;t<s.points.length-1;t++){const n=s.points[t],l=s.points[t+1],o=Math.hypot(n[0]-e.x,n[1]-e.y),r=Math.hypot(l[0]-e.x,l[1]-e.y),u=Math.hypot(n[0]-l[0],n[1]-l[1]);if(o<a||r<a||o+r-u<a){i=s;break}}if(i)break}}return i?qt(i):void 0},vn=(e,t,n,l,o,a)=>{const i=e-o-a,s=e+n+o,r=(s+i)/2,u=t-o-a,c=t+l+o,v=(c+u)/2,d=[i,u,a,a],h=[i,v,a,a],p=[i,c,a,a],f=[r,u,a,a],g=[r,c,a,a],w=[s,u,a,a],m=[s,v,a,a],y=[s,c,a,a],b=[r,u-2*a,a,a];return{LEFT_TOP:d,LEFT:h,LEFT_BOTTOM:p,TOP:f,BOTTOM:g,RIGHT_TOP:w,RIGHT:m,RIGHT_BOTTOM:y,ANGLE:b}};var dn;(function(e){e["LEFT_TOP"]="nwse-resize",e["LEFT"]="ew-resize",e["LEFT_BOTTOM"]="nesw-resize",e["TOP"]="ns-resize",e["BOTTOM"]="ns-resize",e["RIGHT_TOP"]="nesw-resize",e["RIGHT"]="ew-resize",e["RIGHT_BOTTOM"]="nwse-resize",e["ANGLE"]="grabbing",e["MOVE"]="move"})(dn||(dn={}));const hn=(e,t,n,l,o)=>{const a=wn(e[0],e[1],n,l,-o),i=t[0],s=t[0]+t[2],r=t[1],u=t[1]+t[3];return a[0]>i&&a[0]<s&&a[1]>r&&a[1]<u},pn=(e,t,n)=>{const[l,o,a,i]=en(t),s=a-l,r=i-o,u=4/n,c=8/n,v=vn(l,o,s,r,u,c),d=(l+a)/2,h=(o+i)/2;let p="";for(const f in v)if(hn(e,v[f],d,h,t.angle)){p=f;break}return p},fn=(e,t)=>t.find((t=>t.id===e)),gn=e=>e>=2*Math.PI?e-2*Math.PI:e,wn=(e,t,n,l,o)=>[(e-n)*Math.cos(o)-(t-l)*Math.sin(o)+n,(e-n)*Math.sin(o)+(t-l)*Math.cos(o)+l];var mn=(e,t)=>{const n=t=>(e.value.push(t),t),o=({x:e,y:o})=>n({id:Vt(),type:l.PEN,width:0,height:0,x:e,y:o,points:[[0,0]],angle:0,isDelete:!1,locked:!1,lineWidth:t.lineWidth,strokeColor:t.strokeColor});return{createPenElement:o}},yn=n(7327),bn=n(3831);const En="WHITE_BOARD_DB";class kn{constructor(){(0,yn.Z)(this,"db",void 0)}async init(){this.db||(this.db=await(0,bn.X3)(En,1,{upgrade(e){if(!e.objectStoreNames.contains("history")){const t=e.createObjectStore("history",{keyPath:"id",autoIncrement:!0});t.createIndex("id","id",{unique:!0})}}}))}async delete(e){for(const t of e)await(this.db?.transaction("history","readwrite").objectStore("history").delete(t))}async getData(e){return await(this.db?.transaction("history").objectStore("history").get(e))}async getAllKeys(){return await(this.db?.transaction("history").objectStore("history").getAllKeys())}async setData(e){this.db?.transaction("history","readwrite").objectStore("history").add({elements:JSON.parse(JSON.stringify(e))})}}var xn=new kn,_n=(e,t,n,l)=>{const o=(0,ve.debounce)((async e=>{n.value<t.value.length-1&&await xn["delete"](t.value.slice(n.value+1)),await xn.setData(e),await a()}),300),a=async()=>{if(t.value=await xn.getAllKeys(),!t.value||0===t.value.length)return{elements:[]};const l=await xn.getData(t.value[t.value.length-1]);n.value=t.value.length-1,e.value=l.elements},i=async()=>{n.value>-1&&(n.value--,r())},s=()=>{n.value<t.value.length-1&&(n.value++,r())},r=async()=>{if(-1===n.value)return e.value=[],l&&l([]);const o=t.value[n.value],a=await xn.getData(o);e.value=a.elements,l&&l(a.elements)};return{addHistorySnapshot:o,getHistorySnapshot:a,undo:i,redo:s}},On=(e,t,n,o)=>{const a=e=>{t.value&&(t.value.clearRect(...e),t.value.strokeRect(...e))},i=e=>{if(!t.value)return;t.value.save(),t.value.scale(window.devicePixelRatio*n.zoom,window.devicePixelRatio*n.zoom);const[l,o,i,s]=en(e),r=i-l,u=s-o,c=4/n.zoom,v=8/n.zoom,d=4/n.zoom,h=(l+i)/2+n.scrollX,p=(o+s)/2+n.scrollY;t.value.translate(h,p),t.value.rotate(e.angle),t.value.strokeStyle="#333",t.value.lineWidth=1/n.zoom,t.value.setLineDash([v,d]),t.value.strokeRect(-r/2-c,-u/2-c,r+2*c,u+2*c);const f=vn(-r/2,-u/2,r,u,c,v);t.value.setLineDash([0,0]);for(const t in f)a(f[t]);t.value.restore()},s=e=>{if(e.points.length<2||!t.value)return;const[l,o,a,i]=en(e),s=(l+a)/2+n.scrollX,r=(o+i)/2+n.scrollY,u=(a-l)/2-(e.x-l),c=(i-o)/2-(e.y-o);t.value.save(),t.value.scale(window.devicePixelRatio*n.zoom,window.devicePixelRatio*n.zoom),t.value.translate(s,r),t.value.rotate(e.angle),t.value.translate(-u,-c),t.value.fillStyle=e.strokeColor;const v=on(e.points,e.lineWidth);t.value.fill(v),t.value.stroke(),t.value.restore()},r=a=>{if(!e.value||!t.value)return;const r=e.value.width/n.zoom,u=e.value.height/n.zoom;t.value.clearRect(0,0,e.value.width,e.value.height);const c=rn(a,n.scrollX,n.scrollY,r,u);if(c.forEach((e=>{if(!e.isDelete)switch(e.type){case l.PEN:s(e);break}})),o.value){const e=fn(o.value.id,a);e&&i(e)}};return{renderElements:r,renderPenElement:s}},Sn=e=>{const t=(t,n)=>{const l=e.value.findIndex((e=>e.id===t.id));for(const e in n)t[e]=n[e];e.value[l]=t};return{updateElement:t}},Cn=(e,t,n,l,o)=>{const{updateElement:a}=Sn(n),{renderElements:i}=On(e,t,l,o),s=(e,t,n,l,a,i)=>{const s=Math.abs(o.value.width),r=o.value.angle,u=[n-10,l],c=wn(u[0],u[1],n,l,r),v={x:e-n,y:t-l},d={x:c[0]-n,y:c[1]-l},h=Math.hypot(d.x,d.y),p=v.x*d.x+v.y*d.y,f=p/h*a,g=s-f,w=g/s,m=Math.abs(i)*(w-1),y=(g-s)/2;return{width:g,scaleX:w,ofx:m*Math.cos(r)*a,ofy:m*Math.sin(r)*a,cfx:y*Math.cos(r)*a,cfy:y*Math.sin(r)*a}},r=(e,t,n,l,a,i)=>{const s=Math.abs(o.value.height),r=o.value.angle,u=[n,l-10],c=wn(u[0],u[1],n,l,r),v={x:e-n,y:t-l},d={x:c[0]-n,y:c[1]-l},h=Math.hypot(d.x,d.y),p=v.x*d.x+v.y*d.y,f=p/h*a,g=s-f,w=g/s,m=Math.abs(i)*(w-1),y=(g-s)/2;return{height:g,scaleY:w,ofx:-m*Math.sin(r)*a,ofy:m*Math.cos(r)*a,cfx:-y*Math.sin(r)*a,cfy:y*Math.cos(r)*a}},u=(e,t,u)=>{if(!o.value||!e)return;const c=t-e[0],v=u-e[1],[d,h,p,f]=Qt(o.value.points),g=fn(o.value.id,n.value);switch(dn[l.elementOption]){case dn.MOVE:g&&a(g,{x:o.value.x+c,y:o.value.y+v});break;case dn.ANGLE:if(g){const{cx:n,cy:l}=$t(o.value),i=Math.atan2(e[1]-l,e[0]-n),s=Math.atan2(u-l,t-n)-i,r=gn(o.value.angle+s);a(g,{angle:r})}break;case dn.LEFT:case dn.LEFT_TOP:case dn.LEFT_BOTTOM:case dn.TOP:case dn.BOTTOM:case dn.RIGHT:case dn.RIGHT_TOP:case dn.RIGHT_BOTTOM:{const n=qt(o.value.points),{cx:i,cy:c}=$t(o.value),[v,w]=wn(o.value.x,o.value.y,i,c,o.value.angle),m={x:1,y:1},y={width:o.value.width,height:o.value.height},b={x:v,y:w},E={x:i,y:c};if(/LEFT/.test(l.elementOption)){const{width:n,ofx:l,ofy:o,cfx:a,cfy:i,scaleX:r}=s(t,u,e[0],e[1],-1,p);y.width=n,b.x=b.x+l,b.y=b.y+o,E.x=E.x+a,E.y=E.y+i,m.x=r}if(/RIGHT/.test(l.elementOption)){const{width:n,ofx:l,ofy:o,cfx:a,cfy:i,scaleX:r}=s(t,u,e[0],e[1],1,d);y.width=n,b.x=b.x+l,b.y=b.y+o,E.x=E.x+a,E.y=E.y+i,m.x=r}if(/TOP/.test(l.elementOption)){const{height:n,ofx:l,ofy:o,cfx:a,cfy:i,scaleY:s}=r(t,u,e[0],e[1],-1,f);y.height=n,b.x=b.x+l,b.y=b.y+o,E.x=E.x+a,E.y=E.y+i,m.y=s}if(/BOTTOM/.test(l.elementOption)){const{height:n,ofx:l,ofy:o,cfx:a,cfy:i,scaleY:s}=r(t,u,e[0],e[1],1,h);y.height=n,b.x=b.x+l,b.y=b.y+o,E.x=E.x+a,E.y=E.y+i,m.y=s}const[k,x]=wn(b.x,b.y,E.x,E.y,-o.value.angle);a(g,{width:y.width,height:y.height,points:n.map((e=>[e[0]*m.x,e[1]*m.y])),x:k,y:x});break}}i(n.value)};return{optionElement:u}},Mn=(e,t,n,o,a,i,s,r)=>{const{createPenElement:u}=mn(n,o),{updateElement:c}=Sn(n),{renderElements:v}=On(e,t,o,r),{optionElement:d}=Cn(e,t,n,o,r),{addHistorySnapshot:h}=_n(n,a,i);let p=null,f=null;const g=(e,t)=>{if(o.elementOption=s.value?"MOVE":"",r.value){const n=pn([e,t],r.value,o.zoom);n&&(o.elementOption=n)}},w=e=>{if(f&&o.isMoveOrScale){const{x:t,y:l}=Gt(e,o);o.scrollX+=t-f[0],o.scrollY+=l-f[1],f=[t,l],v(n.value)}},m=t=>{if("CANVAS"===t.target.tagName)if(o.isMoveOrScale){const{x:e,y:n}=Gt(t,o);f=[e,n]}else switch(o.optionType){case l.MOUSE:{const{x:l,y:a}=Kt(t,o);if(f=[l,a],r.value){if(o.elementOption="",s.value&&(o.elementOption="MOVE",r.value.id!==s.value.id&&(r.value=qt(fn(s.value.id,n.value)))),!r.value)return;const e=pn([l,a],r.value,o.zoom);e&&(o.elementOption=e),o.elementOption&&(r.value=qt(fn(r.value.id,n.value)),o.isElementOption=!0)}if(!o.isElementOption){const t=e.value.width/o.zoom,i=e.value.height/o.zoom,s=rn(n.value,o.scrollX,o.scrollY,t,i);r.value=cn(s,o.zoom,l,a,r.value),r.value&&(o.elementOption="MOVE",o.isElementOption=!0)}v(n.value);break}case l.PEN:{const{x:e,y:n}=Kt(t,o);p=u({x:e,y:n}),o.isDrawing=!0;break}case l.ERASER:{const{x:e,y:n}=Kt(t,o);f=[e,n],o.isDrawing=!0;break}}},y=tn((t=>{if(o.isDrawing)switch(o.optionType){case l.MOUSE:break;case l.PEN:{if(!p)return;const{x:e,y:n}=Kt(t,o);b(e,n);break}case l.ERASER:{if(!f)return;const{x:l,y:a}=Kt(t,o),i=e.value.width/o.zoom,s=e.value.height/o.zoom,r=rn(n.value,o.scrollX,o.scrollY,i,s);sn(f,l,a,r),v(n.value),f=[l,a];break}}else if(o.isMoveOrScale)w(t);else if(o.optionType===l.MOUSE){const{x:l,y:a}=Kt(t,o);if(o.isElementOption)return d(f,l,a),void(o.isRecordElementOption=!0);const i=e.value.width/o.zoom,u=e.value.height/o.zoom,c=rn(n.value,o.scrollX,o.scrollY,i,u);s.value=cn(c,o.zoom,l,a,r.value),o.isElementOption||g(l,a)}})),b=(e,t)=>{if(p){switch(p.type){case l.PEN:{const n=p.points;c(p,{points:[...n,[e-p.x,t-p.y]]});break}}v(n.value)}},E=e=>{if(o.isDrawing)switch(o.optionType){case l.MOUSE:break;case l.PEN:{if(!p)return;const t=p.points;if(1===t.length)c(p,{points:[...t,[1e-4,1e-4]]});else{const{x:n,y:l}=Kt(e,o);c(p,{points:[...t,[n-p.x,l-p.y]]})}const[l,a,i,s]=Qt(p.points);c(p,{width:i-l,height:s-a}),h(n.value),v(n.value);break}case l.ERASER:n.value=n.value.filter((e=>!e.isDelete)),h(n.value),v(n.value);break}else w(e);if(p=null,f=null,o.isDrawing=!1,o.isElementOption){r.value=qt(fn(r.value.id,n.value));const{x:t,y:l}=Kt(e,o);g(t,l),o.isRecordElementOption&&h(n.value)}o.isElementOption=!1},k=e=>{"Meta"!==e.key&&"Control"!==e.key||(o.isMoveOrScale=!0)},x=e=>{"Meta"!==e.key&&"Control"!==e.key||(o.isMoveOrScale=!1)};return{handleDown:m,handleMove:y,handleUp:E,watchKeyUp:x,watchKeyDown:k}},Rn=(e,t)=>{const n=()=>({x:e.value.width/2,y:e.value.height/2}),l=(e,n,l,o)=>{const{scrollX:a,scrollY:i}=Jt(l,o,t,e,n);t.scrollX=a,t.scrollY=i},o=(e,n,o)=>{const a=e-t.offsetX,i=n-t.offsetY,s=Math.sign(o),r=10,u=Math.abs(o);let c=o;u>r&&(c=r*s);const v=t.zoom-c/100,d=t.zoom;t.zoom=v,l(v,d,a,i)};return{getWhiteBoardCenter:n,updateScroll:l,handleWeel:o}},Tn=(e,t,n,l)=>{const o=()=>{e.value&&t.value&&(t.value.clearRect(0,0,e.value.width,e.value.height),n.value=[],l.lineWidth=5,l.scrollX=0,l.scrollY=0,l.zoom=1,l.strokeColor="#000000")};return{clearElements:o}};const zn=["width","height"];var Un=(0,a.aZ)({__name:"index",setup(e){const t=window.devicePixelRatio,n=(0,i.iH)(null),r=(0,i.iH)(null),u=(0,i.iH)(null),c=(0,i.iH)(0*t),v=(0,i.iH)(0*t),d=(0,i.iH)("0px"),h=(0,i.iH)("0px"),p=(0,i.iH)(-1),f=(0,i.iH)([]),g=(0,i.iH)(),w=(0,i.iH)(),m=(0,a.Fl)((()=>y.isMoveOrScale?"grabbing":y.elementOption?dn[y.elementOption]:{MOUSE:"default",PEN:"crosshair",ERASER:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAARRJREFUOE/dlDFLxEAQhd+BVouFZ3vlQuwSyI+5a7PBRkk6k9KzTOwStJFsWv0xgaQzkNLWszim0kL2OOFc9oKRYHFTz37Lm/dmJhi5JiPzcBjAOYDz7WheADz3jalP8oIxds85P3Zd90RBqqpad133SUSXAJ5M4H3AhWVZd1EUzYQQP96VZYkkSV7btr02QY1Axtgqz/NTz/OM6qSUCMNwRURneoMJOLdt+7Gu643MfeU4zrppmgt9pibgjRBiWRRFb0R934eUcgngdrfxX4CjSwZj7C3Lsqnu8Lc05XQQBO9ENP2NKapnE5s4jme608rhNE2HxWb7qwr2A+f8SAv2BxFdDQ32rpLRVu9Pl+0wztcg6V/VPW4Vw1FsawAAAABJRU5ErkJggg==') 10 10, auto"}[y.optionType])),y=(0,i.qj)({offsetX:0,offsetY:0,scrollX:0,scrollY:0,zoom:1,optionType:l.MOUSE,lineWidth:5,strokeColor:"#000000",isDrawing:!1,isMoveOrScale:!1,elementOption:"",isElementOption:!1,isRecordElementOption:!1}),b="ontouchstart"in window,E=(0,i.iH)([]),{handleDown:k,handleMove:x,handleUp:_,watchKeyDown:O,watchKeyUp:S}=Mn(r,u,E,y,f,p,g,w),{renderElements:C}=On(r,u,y,w),{updateScroll:M,handleWeel:R}=Rn(r,y),{clearElements:T}=Tn(r,u,E,y),{getHistorySnapshot:z,undo:U,redo:A}=_n(E,f,p,C),D=(e,t)=>{M(e,t,r.value.width/2,r.value.height/2),C(E.value)},L=(0,ve.throttle)((e=>{(e.metaKey||e.ctrlKey)&&(R(e.pageX,e.pageY,e.deltaY),C(E.value))}),30);return(0,a.Y3)((async()=>{if(await xn.init(),!r.value||!n.value)return;u.value=r.value.getContext("2d"),window.addEventListener("keydown",O),window.addEventListener("keyup",S),b?(window.addEventListener("touchstart",k),window.addEventListener("touchmove",x),window.addEventListener("touchend",_)):(window.addEventListener("pointerdown",k),window.addEventListener("pointermove",x),window.addEventListener("pointerup",_));const e=(0,ve.throttle)((()=>{n.value&&u.value&&(c.value=n.value.clientWidth*t,v.value=n.value.clientHeight*t,d.value=n.value.clientWidth+"px",h.value=n.value.clientHeight+"px",u.value.scale(t,t),u.value.setTransform(1,0,0,1,0,0),u.value.save(),(0,a.Y3)((async()=>{await z(),C(E.value)})))}),100),l=new ResizeObserver(e);l.observe(n.value)})),(0,a.Ah)((()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",S),b?(window.removeEventListener("touchstart",k),window.removeEventListener("touchmove",x),window.removeEventListener("touchend",_)):(window.removeEventListener("pointerdown",k),window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",_))})),(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"white-board",ref_key:"whiteboard",ref:n},[(0,a._)("canvas",{ref_key:"canvas",ref:r,width:c.value,height:v.value,onMousewheel:t[0]||(t[0]=(0,o.iM)(((...e)=>(0,i.SU)(L)&&(0,i.SU)(L)(...e)),["prevent"])),style:(0,s.j5)({width:d.value,height:h.value,cursor:(0,i.SU)(m)})},null,44,zn),(0,a.Wm)(Ft,{strokeColor:y.strokeColor,"onUpdate:strokeColor":t[1]||(t[1]=e=>y.strokeColor=e),optionType:y.optionType,"onUpdate:optionType":t[2]||(t[2]=e=>y.optionType=e),lineWidth:y.lineWidth,"onUpdate:lineWidth":t[3]||(t[3]=e=>y.lineWidth=e),zoom:y.zoom,"onUpdate:zoom":t[4]||(t[4]=e=>y.zoom=e),snapshotCursor:p.value,snapshotKeys:f.value,onUndo:(0,i.SU)(U),onRedo:(0,i.SU)(A),onZoomChange:D,onClear:(0,i.SU)(T)},null,8,["strokeColor","optionType","lineWidth","zoom","snapshotCursor","snapshotKeys","onUndo","onRedo","onClear"])],512))}});const An=Un;var Dn=An,Ln=(0,a.aZ)({__name:"App",setup(e){return(e,t)=>((0,a.wg)(),(0,a.j4)(Dn))}});const Hn=Ln;var Wn=Hn;(0,o.ri)(Wn).mount("#app")}},t={};function n(l){var o=t[l];if(void 0!==o)return o.exports;var a=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,function(){var e=[];n.O=function(t,l,o,a){if(!l){var i=1/0;for(c=0;c<e.length;c++){l=e[c][0],o=e[c][1],a=e[c][2];for(var s=!0,r=0;r<l.length;r++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](l[r])}))?l.splice(r--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[l,o,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var o,a,i=l[0],s=l[1],r=l[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(r)var c=r(n)}for(t&&t(l);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},l=self["webpackChunkwhiteboard"]=self["webpackChunkwhiteboard"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[998],(function(){return n(7332)}));l=n.O(l)})();