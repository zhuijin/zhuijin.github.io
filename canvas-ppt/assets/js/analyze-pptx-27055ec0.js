var t=Object.defineProperty,e=(e,i,l)=>(((e,i,l)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[i]=l})(e,"symbol"!=typeof i?i+"":i,l),l);import{J as i}from"./jszip-d3992526.js";import{X as l}from"./x2js-49edc794.js";import{h as s}from"./d3-color-e929203e.js";class r{constructor(t){e(this,"_theme"),this._theme=t.theme.themeElements}get theme(){return this._theme}}class a{constructor(t,i){var l,r,a,o,n;if(e(this,"color",""),e(this,"_val",""),e(this,"alpha","100000"),t.schemeClr){this._val=t.schemeClr._val,this.alpha=null==(l=t.schemeClr.alpha)?void 0:l._val;const e=null==(r=i.clrScheme[this._val])?void 0:r.srgbClr;if(e){this.color=("#"+e._val).toLocaleUpperCase();let i=s(this.color);if(t.schemeClr.lumMod||t.schemeClr.lumOff){const e=(+(null==(a=t.schemeClr.lumMod)?void 0:a._val)||0)/1e5,l=(+(null==(o=t.schemeClr.lumOff)?void 0:o._val)||0)/1e5;0!=l&&(i.l=100*(i.l*(e/100)+l/100))}if(t.schemeClr.tint){const e=+t.schemeClr.tint._val/1e3,l=i.rgb();l.r=l.r*e/100+255*(1-e/100),l.g=l.g*e/100+255*(1-e/100),l.b=l.b*e/100+255*(1-e/100),i=s(l)}this.color=i.hex().toLocaleUpperCase()}}else t.srgbClr?(this.alpha=null==(n=t.srgbClr.alpha)?void 0:n._val,this.color=("#"+t.srgbClr._val).toLocaleUpperCase()):t.prstClr&&(this.color=t.prstClr._val)}}class o extends a{constructor(t,e){super(t,e)}}class n{constructor(t,i){e(this,"_blipFill"),e(this,"_relationships"),this._blipFill=t,this._relationships=i}get src(){const t=this._blipFill.blip["_r:embed"],e=this._relationships.find((e=>e._Id===t));return(null==e?void 0:e._Target)||""}get opacity(){var t;return+((null==(t=this._blipFill.blip.alphaModFix)?void 0:t._amt)||0)/1e3}get stretch(){return this._blipFill.stretch}get tile(){return this._blipFill.tile}}class c{constructor(t,i){e(this,"_gradFill"),e(this,"_theme"),this._gradFill=t,this._theme=i}get color(){return this._gradFill.gsLst.gs.map((t=>{const e=new o(t,this._theme);let i=e.color;if(e.alpha){const t=+e.alpha/1e5;i=(i+Math.floor(255*t).toString(16)).toLocaleUpperCase()}return i?{pos:t._pos,value:i}:{}})).filter((t=>!!t.value))}get rotate(){if(this._gradFill.lin){const t=+(this._gradFill.lin._ang||0)/6e4-90;return t<0?360+t:t}return 0}get type(){return this._gradFill.lin?"linear":this._gradFill.path?"radial":"linear"}}class h{constructor(t,i,l){e(this,"_type","solid"),e(this,"_solidFill",null),e(this,"_blipFill",null),e(this,"_gradFill",null),e(this,"_relationships"),this._relationships=l,t.bgPr.solidFill&&(this._solidFill=new o(t.bgPr.solidFill,i),this._type="solid"),t.bgPr.blipFill&&(this._blipFill=new n(t.bgPr.blipFill,this._relationships),this._type="image"),t.bgPr.gradFill&&(this._gradFill=new c(t.bgPr.gradFill,i),this._type="gradient")}get type(){return this._type}get color(){let t=this._solidFill.color;if(this._solidFill.alpha){const e=+this._solidFill.alpha/1e5;t=(t+Math.floor(255*e).toString(16)).toLocaleUpperCase()}return t||""}get gradientColor(){var t;return null==(t=this._gradFill)?void 0:t.color.map((t=>({offset:+t.pos/1e5,value:t.value})))}get gradientType(){return this._gradFill.type}get gradientRotate(){return this._gradFill.rotate}get imageSrc(){var t;return(null==(t=this._blipFill)?void 0:t.src.replace("..","ppt"))||""}get stretch(){var t;return(null==(t=this._blipFill)?void 0:t.stretch)||""}get tile(){var t;return(null==(t=this._blipFill)?void 0:t.tile)||""}}class p{constructor(t,i){e(this,"_style"),e(this,"_theme"),this._style=t,this._theme=i}get fill(){if(this._style&&this._style.fillRef){return new o(this._style.fillRef,this._theme).color}return""}get ln(){if(this._style&&this._style.lnRef){return new o(this._style.lnRef,this._theme).color}return""}}const d=(t=6)=>{const e="_0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let i="";for(let l=0;l<t;l++){i+=e[Math.floor(63*Math.random())]}return i},_=t=>{if(!isNaN(t))return+t/12700/3*4},f=(t=0)=>Math.round(t/6e4);var u,g;(g=u||(u={})).rect="rect",g.roundRect="rectRadius",g.snip1Rect="rectMinusSingleAngle",g.snip2SameRect="rectMinusSameSideAngle",g.snip2DiagRect="rectMinusOppositeAngle",g.snipRoundRect="rectSingleRadiusMinusSingleAngle",g.round1Rect="rectSingleRadius",g.round2SameRect="rectSameSideRadius",g.round2DiagRect="rectOppositeRadius",g.ellipse="oval",g.triangle="triangle",g.rtTriangle="rightTriangle",g.parallelogram="parallelogram",g.trapezoid="trapezoidal",g.diamond="diamond",g.pentagon="pentagon",g.hexagon="hexagon",g.heptagon="heptagon",g.octagon="octagon",g.decagon="decagon",g.dodecagon="dodecagon",g.pie="pieShape",g.chord="chordShape",g.teardrop="teardropShape",g.frame="frameShape",g.halfFrame="halfClosedFrameShape",g.corner="horn",g.diagStripe="twill",g.plus="cross",g.plaque="cutawayRectangle",g.donut="ring";const m={title:"title",subTitle:"body",ctrTitle:"title"},v=[{label:"Arial",value:"Arial"},{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:"SimSun"},{label:"黑体",value:"SimHei"},{label:"楷体",value:"KaiTi"},{label:"新宋体",value:"NSimSun"},{label:"仿宋",value:"FangSong"},{label:"苹方",value:"PingFang SC"},{label:"华文黑体",value:"STHeiti"},{label:"华文楷体",value:"STKaiti"},{label:"华文宋体",value:"STSong"},{label:"华文仿宋",value:"STFangSong"},{label:"华文中宋",value:"STZhongSong"},{label:"华文琥珀",value:"STHupo"},{label:"华文新魏",value:"STXinwei"},{label:"华文隶书",value:"STLiti"},{label:"华文行楷",value:"STXingkai"},{label:"冬青黑体",value:"Hiragino Sans GB"},{label:"兰亭黑",value:"Lantinghei SC"},{label:"偏偏体",value:"Hanzipen SC"},{label:"手札体",value:"Hannotate SC"},{label:"宋体",value:"Songti SC"},{label:"娃娃体",value:"Wawati SC"},{label:"行楷",value:"Xingkai SC"},{label:"圆体",value:"Yuanti SC"},{label:"华文细黑",value:"STXihei"},{label:"幼圆",value:"YouYuan"},{label:"隶书",value:"LiSu"}];class y{constructor(t,i,l,s){e(this,"_sps",[]),e(this,"_theme"),e(this,"_sldLayout"),e(this,"_sldMaster"),e(this,"_ctx"),e(this,"_titleLvlPprs",[]),e(this,"_bodyLvlPprs",[]),e(this,"_otherLvlPprs",[]),e(this,"_layoutStyle",{}),this._theme=i,this._sldLayout=l,this._sldMaster=s;const r=t instanceof Array;this._sps=r?t:[t];const a=document.createElement("canvas");a.style.width="100px",a.style.height="100px";const o=window.devicePixelRatio;a.width=100*o,a.height=100*o,this._ctx=a.getContext("2d",{willReadFrequently:!0}),this._ctx.scale(o,o),this._titleLvlPprs=this.dealTexStyle(this._sldMaster.txStyles.titleStyle),this._bodyLvlPprs=this.dealTexStyle(this._sldMaster.txStyles.bodyStyle),this._otherLvlPprs=this.dealTexStyle(this._sldMaster.txStyles.otherStyle),this._layoutStyle=this.dealLayoutStyle()}getFontSize(t){this._ctx.font=`${t.fontStyle} ${t.fontWeight} ${t.fontSize}px ${t.fontFamily}`;const e=this._ctx.measureText(t.value);return{width:e.width,height:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}}dealTexStyle(t){var e,i;const l=[];for(const s in t)if(s.indexOf("lvl")>-1){const r=t[s].defRPr;let a="";if(null==(i=null==(e=r.solidFill)?void 0:e.schemeClr)?void 0:i._val){r.solidFill.schemeClr._val=this._sldMaster.clrMap["_"+r.solidFill.schemeClr._val];const t=new o(r.solidFill,this._theme);if(a=t.color,t.alpha){const e=+t.alpha/1e5;a=(a+Math.floor(255*e).toString(16)).toLocaleUpperCase()}}l.push({size:+r._sz/100/3*4,bold:!!r._b,italic:!!r._i,strike:!!r._strike,fontColor:a,underline:!!r._u&&"none"!==r._u,defRpr:r,align:t[s]._algn})}return l}dealLayoutStyle(){var t;const e={};let i=[];i=this._sldLayout.cSld.spTree.sp instanceof Array?this._sldLayout.cSld.spTree.sp:[this._sldLayout.cSld.spTree.sp];for(const l of i){e[(null==(t=l.nvSpPr.nvPr.ph)?void 0:t._type)||"other"]=this.dealTexStyle(l.txBody.lstStyle)}return e}getLayoutStyle(t,e="0"){return(this._layoutStyle[t]||[])[+e]||{}}getTextStyle(t,e="0"){switch(t){case"title":return this._titleLvlPprs[+e];case"body":return this._bodyLvlPprs[+e];case"other":return this._otherLvlPprs[+e]}return null}getFont(t){let e=this._theme.fontScheme.minorFont;return t?(e=t.indexOf("+mn")>-1?this._theme.fontScheme.minorFont:this._theme.fontScheme.majorFont,t.indexOf("lt")>-1?e.latin._typeface:t.indexOf("ea")>-1?e.ea._typeface:e.cs._typeface||"Arial"):e.latin._typeface}get shapes(){var t,e,i,l,s,r,n;const h=[];for(const g of this._sps){let y="";(null==(t=g.nvSpPr.nvPr.ph)?void 0:t._type)&&(y=g.nvSpPr.nvPr.ph._type);const S=m[y]||y||"other",x=g.spPr.xfrm;let b;g.nvSpPr.cNvSpPr._txBox?b={id:d(),originId:g.nvSpPr.cNvPr._id,type:"text",left:_(x.off._x),top:_(x.off._y),width:_(x.ext._cx),height:_(x.ext._cy),rotate:Math.floor(+(x._rot||"0")/6e4),name:g.nvSpPr.cNvPr._name,align:"left",wordSpace:0,lineHeight:1.2,content:[]}:(b={id:d(),originId:g.nvSpPr.cNvPr._id,fixedRatio:!1,left:_(x.off._x),top:_(x.off._y),width:_(x.ext._cx),height:_(x.ext._cy),rotate:Math.floor(+(x._rot||"0")/6e4),type:"shape",name:g.nvSpPr.cNvPr._name,shape:u[null==(e=g.spPr.prstGeom)?void 0:e._prst]||"rect",align:"center",lineHeight:1.2,wordSpace:0,content:[]},g.nvSpPr.cNvSpPr.spLocks&&(b.fixedRatio=!0));let P=[];P=g.txBody.p instanceof Array?g.txBody.p:[g.txBody.p];for(const t of P){const e=this.getTextStyle(S,t._lvl),a=this.getLayoutStyle(y,t._lvl);if((null==(i=t.pPr)?void 0:i._algn)?b.align={ctr:"center",l:"left",r:"right"}[t.pPr._algn]||"left":a.align&&(b.align={ctr:"center",l:"left",r:"right"}[a.align]),t.r){const i=[];let n=[];n=t.r instanceof Array?t.r:[t.r];for(const t of n){let n=a.fontColor||e.fontColor||"#000000";if(t.rPr.solidFill){t.rPr.solidFill.schemeClr&&(t.rPr.solidFill.schemeClr._val=this._sldMaster.clrMap["_"+t.rPr.solidFill.schemeClr._val]||t.rPr.solidFill.schemeClr._val);const e=new o(t.rPr.solidFill,this._theme);if(n=e.color,e.alpha){const t=+e.alpha/1e5;n=(n+Math.floor(255*t).toString(16)).toLocaleUpperCase()}}if(t.t.__text){const o=(null==(l=t.rPr.latin)?void 0:l._typeface)||(null==(s=t.rPr.ea)?void 0:s._typeface)||this.getFont((null==(r=t.rPr.sym)?void 0:r._typeface)||""),c=v.find((t=>t.label===o)),h=c?c.value:o;for(const l of t.t.__text){const s={value:l,fontSize:t.rPr._sz?+t.rPr._sz/100/3*4:a.size||e.size,width:24,height:24,fontStyle:t.rPr._i||a.italic||e.italic?"italic":"normal",fontWeight:t.rPr._b||a.bold||e.bold?"bold":"normal",fontFamily:h,fontColor:n,underline:!!t.rPr._u&&"none"!==t.rPr._u||a.underline||e.underline,strikout:!!t.rPr._strike},{width:r,height:o}=this.getFontSize(s);s.width=r,s.height=o,i.push(s)}}}const c=i.length-1,h=c>-1?i[c]:{},p={fontSize:e.size,width:24,height:24,fontStyle:e.italic?"italic":"normal",fontWeight:e.bold?"bold":"normal",fontFamily:e.fontFamily,fontColor:e.fontColor,underline:e.underline,strikout:e.strike,...h,value:"\n"};i.push(p),b.content=b.content.concat(i)}}const F=new p(g.style,this._theme);if(!g.spPr.noFill)if(g.spPr.solidFill){const t=new o(g.spPr.solidFill,this._theme),e=+t.alpha/1e3;b.fill={color:t.color,opacity:e}}else if(g.spPr.gradFill){const t=new c(g.spPr.gradFill,this._theme);b.gradient={type:t.type,color:t.color.map((t=>({offset:+t.pos/1e5,value:t.value}))),rotate:t.rotate}}else F.fill&&(b.fill={color:F.fill});if(g.spPr.ln){const t=g.spPr.ln;if(!t.noFill&&t.solidFill){const e=new o(t.solidFill,this._theme),i=+e.alpha/1e3,l=_(t._w||"12700");b.outline={color:e.color,opacity:i,width:l}}}else F.ln&&(b.outline={color:F.ln,width:_("12700")});if(x._flipH&&(b.flipH=-1),x._flipV&&(b.flipV=-1),null==(n=g.spPr.effectLst)?void 0:n.outerShdw){const t=g.spPr.effectLst.outerShdw,e=new a(t,this._theme),i=(e.color+Math.floor(255*+e.alpha/1e5).toString(16)).toLocaleUpperCase(),l=f(+t._dir||0),s=_(t._dist||0),r=s*Math.sin((90-l)/180*Math.PI),o=s*Math.sin(l/180*Math.PI);b.shadow={color:i,h:r,v:o,blur:_(t._blurRad||0)}}h.push(b)}return h}}class S{constructor(t,i){e(this,"_cxnSps"),e(this,"_theme"),this._theme=i;const l=t instanceof Array;this._cxnSps=l?t:[t]}get lines(){var t,e,i;const l=[];for(const s of this._cxnSps){const r=new p(s.style,this._theme),a={id:d(),originId:s.nvCxnSpPr.cNvPr._id,left:_(s.spPr.xfrm.off._x),top:_(s.spPr.xfrm.off._y),start:[0,0],end:[_(s.spPr.xfrm.ext._cx),_(s.spPr.xfrm.ext._cy)],type:"line",name:s.nvCxnSpPr.cNvPr._name,style:"solid",color:r.ln,startStyle:"",endStyle:"",borderWidth:2,opacity:0};if(s.spPr.ln){const l=s.spPr.ln;if(l.solidFill){const t=new o(l.solidFill,this._theme);a.color=t.color,a.opacity=+t.alpha/1e3}a.style=(null==(t=l.prstDash)?void 0:t._val)||"solid",a.borderWidth=_(l._w||"12700"),a.startStyle=(null==(e=l.headEnd)?void 0:e._type)||"",a.endStyle=(null==(i=l.tailEnd)?void 0:i._type)||""}l.push(a)}return l}}class x{constructor(t,i,l){e(this,"_pics"),e(this,"_theme"),e(this,"_relationships"),this._theme=i,this._relationships=l;const s=t instanceof Array;this._pics=s?t:[t]}get pictures(){var t;const e=[];for(const i of this._pics){const l=i.spPr.xfrm,{videoFile:s,audioFile:r}=i.nvPicPr.nvPr,c={id:d(),originId:i.nvPicPr.cNvPr._id,fixedRatio:!1,left:_(l.off._x),top:_(l.off._y),width:_(l.ext._cx),height:_(l.ext._cy),type:s?"video":r?"audio":"image",name:i.nvPicPr.cNvPr._name,rotate:Math.floor(+(l._rot||"0")/6e4),streach:0,src:""};if(i.nvPicPr.cNvPicPr.picLocks&&(c.fixedRatio=!0),l._flipH&&(c.flipH=-1),l._flipV&&(c.flipV=-1),i.blipFill){const t=new n(i.blipFill,this._relationships);c.src=(null==t?void 0:t.src.replace("..","ppt"))||"",(s||r)&&(c.cover=c.src),c.opacity=t.opacity}if(s){const t=s["_r:link"],e=this._relationships.find((e=>e._Id===t));c.src=(null==e?void 0:e._Target.replace("..","ppt"))||""}if(r){const t=r["_r:link"],e=this._relationships.find((e=>e._Id===t));c.src=(null==e?void 0:e._Target.replace("..","ppt"))||""}if(i.spPr.solidFill){const t=new o(i.spPr.solidFill,this._theme),e=+t.alpha/1e3;c.fill={color:t.color,opacity:e}}if(i.spPr.ln){const t=i.spPr.ln;if(!t.noFill&&t.solidFill){const e=new o(t.solidFill,this._theme),i=+e.alpha/1e3,l=_(t._w||"12700");c.outline={color:e.color,opacity:i,width:l}}}if(null==(t=i.spPr.effectLst)?void 0:t.outerShdw){const t=i.spPr.effectLst.outerShdw,e=new a(t,this._theme),l=(e.color+Math.floor(255*+e.alpha/1e5).toString(16)).toLocaleUpperCase(),s=f(+t._dir||0),r=_(t._dist||0),o=r*Math.sin((90-s)/180*Math.PI),n=r*Math.sin(s/180*Math.PI);c.shadow={color:l,h:o,v:n,blur:_(t._blurRad||0)}}e.push(c)}return e}}class b{constructor(t,i,l,s){e(this,"_graphicFrames"),e(this,"_relationships"),e(this,"_zip"),e(this,"_x2js"),this._relationships=i,this._zip=l,this._x2js=s;const r=t instanceof Array;this._graphicFrames=r?t:[t]}dealSeries(t){let e=[];const i=[],l=[];for(const s of t)e=s.cat.strRef.strCache.pt.map((t=>t.v.__text)),i.push(s.tx.strRef.strCache.pt.v.__text),l.push(s.val.numRef.numCache.pt.map((t=>+t.v.__text)));return{labels:e,legends:i,series:l}}async getGraphicFrames(){const t=[];for(const e of this._graphicFrames){if(e.graphic.graphicData.chart){const i=e.graphic.graphicData.chart["_r:id"],l=this._relationships.find((t=>t._Id===i)),s=(null==l?void 0:l._Target.replace("..","ppt"))||"",r=await this._zip.file(s).async("string"),a=this._x2js.xml2js(r),o=e.xfrm,n={id:d(),originId:e.nvGraphicFramePr.cNvPr._id,fixedRatio:!1,left:_(o.off._x),top:_(o.off._y),width:_(o.ext._cx),height:_(o.ext._cy),type:"chart",chartType:"bar",axisTransformation:!1,src:"",streach:0,name:e.nvGraphicFramePr.cNvPr._name,rotate:Math.floor(+(o._rot||"0")/6e4),data:{labels:[],legends:[],series:[]}};if(a.chartSpace.chart.plotArea.barChart){const t=a.chartSpace.chart.plotArea.barChart;n.chartType="bar";const e=this.dealSeries(t.ser);n.axisTransformation="bar"===t.barDir._val,n.data=e}if(a.chartSpace.chart.plotArea.lineChart){const t=a.chartSpace.chart.plotArea.lineChart;n.chartType="line";const e=this.dealSeries(t.ser);n.data=e}if(a.chartSpace.chart.plotArea.pieChart){const t=a.chartSpace.chart.plotArea.pieChart;n.chartType="pie";const e=this.dealSeries([t.ser]);n.data=e}t.push(n)}e.graphic.graphicData.tbl}return t}}class P{constructor(t){e(this,"_animations"),this._animations=this.dealAnimations(t)}dealAnimations(t){var e,i,l,s;let r=[];const a=[],o=t.tnLst.par.cTn.childTnLst.seq.cTn.childTnLst.par;r=o instanceof Array?o:[o];for(const n of r){let t=[];const r=n.cTn.childTnLst.par;t=r instanceof Array?r:[r];for(const o of t){const t=o.cTn.childTnLst.par;for(const r of t instanceof Array?t:[t]){const t={entr:"in",emph:"attention",exit:"out",path:"attention"}[r.cTn._presetClass];let o="",n="",c="";if("path"===r.cTn._presetClass)o=null==(e=r.cTn.childTnLst.animMotion)?void 0:e.cBhvr.tgtEl.spTgt._spid,n="custom",c=null==(i=r.cTn.childTnLst.animMotion)?void 0:i._path;else{let t={},e={};for(const i in r.cTn.childTnLst)i.indexOf("anim")>-1?t=r.cTn.childTnLst[i]instanceof Array?r.cTn.childTnLst[i][0]:r.cTn.childTnLst[i]:"set"===i&&(e=r.cTn.childTnLst[i]instanceof Array?r.cTn.childTnLst[i][0]:r.cTn.childTnLst[i]);o=(null==(l=e.cBhvr)?void 0:l.tgtEl.spTgt._spid)||t.cBhvr.tgtEl.spTgt._spid,"emph"===r.cTn._presetClass?(console.log("强调动画",t),n=t._clrSpc||t._calcmode||""):n=null==(s=r.cTn.childTnLst.animEffect)?void 0:s._filter}const h={clickEffect:"click",afterEffect:"auto",withEffect:"meantime"}[r.cTn._nodeType],p={id:d(),elId:o,type:t,ani:n,duration:0,trigger:h,path:c};a.push(p)}}}return a}get animations(){return this._animations}}class F{constructor(t,i,l,s,r,a,o,n){e(this,"_slide"),e(this,"_relationships"),e(this,"_theme"),e(this,"_index",""),e(this,"_zip"),e(this,"_x2js"),e(this,"_sldMaster"),e(this,"_sldLayout"),this._slide=t,this._relationships=i.Relationships.Relationship,this._theme=l,this._index=s,this._zip=r,this._x2js=a,this._sldMaster=n,this._sldLayout=o}async getSlide(){var t;let e;if(this._slide.cSld.bg){const t=new h(this._slide.cSld.bg,this._theme,this._relationships);if(e={type:t.type},"solid"===t.type&&(e.color=t.color),"image"===t.type){const i=t.imageSrc.replace(/.+\./,""),l=await this._zip.file(t.imageSrc).async("base64");e.image=`data:image/${i};base64,`+l,e.imageSize=t.stretch?"cover":"repeat"}"gradient"===t.type&&(e.gradientColor=t.gradientColor,e.gradientType=t.gradientType,e.gradientRotate=t.gradientRotate)}let i=[];if(this._slide.cSld.spTree.sp){const t=new y(this._slide.cSld.spTree.sp,this._theme,this._sldLayout,this._sldMaster);i=i.concat(t.shapes)}if(this._slide.cSld.spTree.cxnSp){const t=new S(this._slide.cSld.spTree.cxnSp,this._theme);i=i.concat(t.lines)}if(this._slide.cSld.spTree.pic){const t=new x(this._slide.cSld.spTree.pic,this._theme,this._relationships).pictures;for(const e of t){const t=e.src.replace(/.+\./,"");if("image"===e.type){const i=await this._zip.file(e.src).async("base64");e.src=`data:image/${t};base64,`+i}else{if(e.cover){const t=e.cover.replace(/.+\./,""),i=await this._zip.file(e.cover).async("base64");e.cover=`data:image/${t};base64,`+i}const i=await this._zip.file(e.src).async("base64");e.src=`data:${e.type}/${t};base64,`+i}}i=i.concat(t)}if(this._slide.cSld.spTree.graphicFrame){const t=new b(this._slide.cSld.spTree.graphicFrame,this._relationships,this._zip,this._x2js),e=await t.getGraphicFrames();i=i.concat(e)}let l=[];if(this._slide.timing){const t=this._slide.timing;l=new P(t).animations}for(const s of l)s.elId=null==(t=i.find((t=>t.originId===s.elId)))?void 0:t.id;for(const s of i)delete s.originId;return{index:+this._index,id:d(),elements:i,...e?{background:e}:{},animations:l}}}class T{constructor(){e(this,"slides",[])}async read(t){const e=new l,s=new i,a=await s.loadAsync(t),o={};for(const i in a.files)if(!a.files[i].dir){const t=a.files[i].name;if(/.xml$/.test(t)||/.rels$/.test(t)){const l=await a.file(a.files[i].name).async("string");o[t]=e.xml2js(l)}}const n=o["ppt/theme/theme1.xml"],c=new r(n).theme,h=o["ppt/slideMasters/slideMaster1.xml"],p=[];try{for(const t in o)if(/ppt\/slides\/slide[\d]+.xml$/.test(t)){const i=/\d+/.exec(t)[0],l=o[`ppt/slides/_rels/slide${i}.xml.rels`];let s;for(const t of l.Relationships.Relationship)if(/slideLayout[\d]+.xml$/.test(t._Target)){s=o[t._Target.replace("..","ppt")]}const r=new F(o[t].sld,l,c,i,a,e,s.sldLayout,h.sldMaster),n=await r.getSlide();p.push(n)}return p.sort(((t,e)=>t.index-e.index)).map((t=>(delete t.index,t)))}catch(d){return console.error(d),p}}}export{T as A};
